<!DOCTYPE html>
<html  lang="zh">
<head>
    <meta charset="utf-8" />

<meta name="generator" content="Hexo 4.2.1" />

<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

<title>in0va&#39;S Blog  JustLearnM0re</title>


    <meta name="description" content="一枚很菜但是仍在学习的二进制菜逼">
<meta property="og:type" content="website">
<meta property="og:title" content="in0va&#39;S Blog  JustLearnM0re">
<meta property="og:url" content="https://driverxdw.github.io/index.html">
<meta property="og:site_name" content="in0va&#39;S Blog  JustLearnM0re">
<meta property="og:description" content="一枚很菜但是仍在学习的二进制菜逼">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://driverxdw.github.io/images/og_image.png">
<meta property="article:author" content="xdw">
<meta property="article:tag" content="hacker 底层 漏洞挖掘">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://driverxdw.github.io/images/og_image.png">







<link rel="icon" href="/images/author.jpg">


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.7.2/css/bulma.css">
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu:400,600|Source+Code+Pro">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css">


    
    
<style>body>.footer,body>.navbar,body>.section{opacity:0}</style>

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css">

    
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.css">

    
    
    
    
<link rel="stylesheet" href="/css/back-to-top.css">

    
    
    
    
    
    
    
    <link rel="stylesheet" href="/css/progressbar.css">
<script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
    
    <script async="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    


<link rel="stylesheet" href="/css/style.css">
</head>
<body class="is-3-column">
    <nav class="navbar navbar-main">
    <div class="container">
        <div class="navbar-brand is-flex-center">
            <a class="navbar-item navbar-logo" href="/">
            
                <img src="/images/logo.svg" alt="in0va&#39;S Blog  JustLearnM0re" height="28">
            
            </a>
        </div>
        <div class="navbar-menu">
            
            <div class="navbar-start">
                
                <a class="navbar-item is-active"
                href="/">Home</a>
                
                <a class="navbar-item"
                href="/archives">Archives</a>
                
                <a class="navbar-item"
                href="/categories">Categories</a>
                
                <a class="navbar-item"
                href="/tags">Tags</a>
                
                <a class="navbar-item"
                href="/about">About</a>
                
            </div>
            
            <div class="navbar-end">
                
                    
                    <a class="navbar-item" target="_blank" title="Download on GitHub" href="https://github.com/driverxdw">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                    
                
                
                
                <a class="navbar-item search" title="搜索" href="javascript:;">
                    <i class="fas fa-search"></i>
                </a>
                
            </div>
        </div>
    </div>
</nav>
    
    <section class="section">
        <div class="container">
            <div class="columns">
                <div class="column is-8-tablet is-8-desktop is-6-widescreen has-order-2 column-main">
    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-08-30</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-08-30T15:50:47.105Z">2020-08-30</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    30 分钟 读完 (大约 4443 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/08/30/Netstat-Source-Code-Debug/">Netstat Source Code Debug</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>之前就对linux上附加的一些小工具像netstat、ps、top等的功能比较感兴趣，虽然知道本质上还是去解析vfs中的信息，但对其细节比较好奇，这边做下源码分析，同时也为后续对其它相对于netstat更复杂的程序/项目的分析做下铺垫，如sysdig、osquery、linux kernel等等；这块spoock江城子师傅已经写过类似的文章，个人觉得写的很好，要点都get到了，作为读者受益匪浅，贴下链接致敬下引路人：<a href="https://blog.spoock.com/2019/05/26/netstat-learn/。下面所做分析可能无法面面俱到，非核心的函数和功能分析将被drop。" target="_blank" rel="noopener">https://blog.spoock.com/2019/05/26/netstat-learn/。下面所做分析可能无法面面俱到，非核心的函数和功能分析将被drop。</a></p>
<h2 id="调试环境"><a href="#调试环境" class="headerlink" title="调试环境"></a>调试环境</h2><p>此次调试是在vscode下使用gdbserver launch远程进行的，调试端的launch.json配置如下，被调端gdbserver挂住就好了</p>
<figure class="highlight json hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">{</span><br><span class="line">    <span class="hljs-comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">    <span class="hljs-comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">    <span class="hljs-comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="hljs-attr">"version"</span>: <span class="hljs-string">"0.2.0"</span>,</span><br><span class="line">    <span class="hljs-attr">"configurations"</span>: [</span><br><span class="line">        {</span><br><span class="line">            <span class="hljs-attr">"name"</span>: <span class="hljs-string">"(gdb) Launch"</span>,</span><br><span class="line">            <span class="hljs-attr">"type"</span>: <span class="hljs-string">"cppdbg"</span>,</span><br><span class="line">            <span class="hljs-attr">"request"</span>: <span class="hljs-string">"launch"</span>,</span><br><span class="line">            <span class="hljs-attr">"program"</span>: <span class="hljs-string">"${workspaceFolder}/netstat"</span>,</span><br><span class="line">            <span class="hljs-attr">"args"</span>: [],</span><br><span class="line">            <span class="hljs-attr">"stopAtEntry"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">            <span class="hljs-attr">"cwd"</span>: <span class="hljs-string">"${workspaceFolder}"</span>,</span><br><span class="line">            <span class="hljs-attr">"environment"</span>: [],</span><br><span class="line">            <span class="hljs-attr">"externalConsole"</span>: <span class="hljs-literal">false</span>,</span><br><span class="line">            <span class="hljs-attr">"MIMode"</span>: <span class="hljs-string">"gdb"</span>,</span><br><span class="line">            <span class="hljs-attr">"linux"</span>: {</span><br><span class="line">                <span class="hljs-attr">"MIMode"</span>: <span class="hljs-string">"gdb"</span>,</span><br><span class="line">                <span class="hljs-attr">"miDebuggerPath"</span>: <span class="hljs-string">"/usr/bin/gdb"</span>,</span><br><span class="line">                <span class="hljs-attr">"miDebuggerServerAddress"</span>: <span class="hljs-string">"10.211.55.4:7777"</span></span><br><span class="line">            },</span><br><span class="line">            <span class="hljs-attr">"setupCommands"</span>: [</span><br><span class="line">                {</span><br><span class="line">                    <span class="hljs-attr">"description"</span>: <span class="hljs-string">"Enable pretty-printing for gdb"</span>,</span><br><span class="line">                    <span class="hljs-attr">"text"</span>: <span class="hljs-string">"-enable-pretty-printing"</span>,</span><br><span class="line">                    <span class="hljs-attr">"ignoreFailures"</span>: <span class="hljs-literal">true</span></span><br><span class="line">                }</span><br><span class="line">            ]</span><br><span class="line">        }</span><br><span class="line">    ]</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<h2 id="源码分析"><a href="#源码分析" class="headerlink" title="源码分析"></a>源码分析</h2><p>2286行之前大量操作用在判断程序启动参数上，并给当作参数标志位使用的变量置位，以及其它一些初始化操作</p>
<figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#if I18N</span></span><br><span class="line">    setlocale (LC_ALL, <span class="hljs-string">""</span>);</span><br><span class="line">    bindtextdomain(<span class="hljs-string">"net-tools"</span>, <span class="hljs-string">"/usr/share/locale"</span>);</span><br><span class="line">    textdomain(<span class="hljs-string">"net-tools"</span>);</span><br><span class="line"><span class="hljs-comment">#endif</span></span><br><span class="line">    getroute_init();		<span class="hljs-regexp">/* Set up AF routing support */</span></span><br><span class="line"></span><br><span class="line">    afname[<span class="hljs-number">0</span>] = <span class="hljs-string">'\0'</span>;</span><br><span class="line">    <span class="hljs-keyword">while</span> ((i = getopt_long(argc, argv, <span class="hljs-string">"A:CFMacdeghilnNoprsStuUvVWw2fx64?Z"</span>, longopts, &lop)) != EOF)</span><br><span class="line">	switch (i) {</span><br><span class="line">	case -<span class="hljs-number">1</span>:</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-number">1</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (lop < <span class="hljs-number">0</span> || lop >= AFTRANS_CNT) {</span><br><span class="line">		EINTERN(<span class="hljs-string">"netstat.c"</span>, <span class="hljs-string">"longopts 1 range"</span>);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line">	    }</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(longopts[lop].name))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'A'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(optarg))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'M'</span>:</span><br><span class="line">	    flag_mas++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'a'</span>:</span><br><span class="line">	    flag_all++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'l'</span>:</span><br><span class="line">	    flag_lst++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'c'</span>:</span><br><span class="line">	    flag_cnt++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	case <span class="hljs-string">'d'</span>:</span><br><span class="line">	    flag_deb++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'g'</span>:</span><br><span class="line">	    flag_igmp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'e'</span>:</span><br><span class="line">	    flag_exp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'p'</span>:</span><br><span class="line">	    flag_prg++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'i'</span>:</span><br><span class="line">	    flag_int++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'W'</span>:</span><br><span class="line">	    flag_wide++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'n'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'!'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM_HOST;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'@'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM_PORT;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'#'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM_USER;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'N'</span>:</span><br><span class="line">	    flag_not |= FLAG_SYM;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'C'</span>:</span><br><span class="line">	    flag_cf |= FLAG_CACHE;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'F'</span>:</span><br><span class="line">	    flag_cf |= FLAG_FIB;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'o'</span>:</span><br><span class="line">	    flag_opt++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'6'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(<span class="hljs-string">"inet6"</span>))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'4'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(<span class="hljs-string">"inet"</span>))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'V'</span>:</span><br><span class="line">	    version();</span><br><span class="line">	    <span class="hljs-regexp">/*NOTREACHED */</span></span><br><span class="line">	case <span class="hljs-string">'v'</span>:</span><br><span class="line">	    flag_ver |= FLAG_VERBOSE;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'r'</span>:</span><br><span class="line">	    flag_rou++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'t'</span>:</span><br><span class="line">	    flag_tcp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'S'</span>:</span><br><span class="line">	    flag_sctp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'u'</span>:</span><br><span class="line">	    flag_udp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">        case <span class="hljs-string">'U'</span>:</span><br><span class="line">	    flag_udplite++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'w'</span>:</span><br><span class="line">	    flag_raw++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">        case <span class="hljs-string">'2'</span>:</span><br><span class="line">	    flag_l2cap++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">        case <span class="hljs-string">'f'</span>:</span><br><span class="line">	    flag_rfcomm++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'x'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(<span class="hljs-string">"unix"</span>))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'Z'</span>:</span><br><span class="line"><span class="hljs-comment">#if HAVE_SELINUX</span></span><br><span class="line">	    <span class="hljs-keyword">if</span> (is_selinux_enabled() <= <span class="hljs-number">0</span>) {</span><br><span class="line">		fprintf(stderr, _(<span class="hljs-string">"SELinux is not enabled on this machine.\n"</span>));</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    }</span><br><span class="line">	    flag_prg++;</span><br><span class="line">	    flag_selinux++;</span><br><span class="line"><span class="hljs-comment">#else</span></span><br><span class="line">            fprintf(stderr, _(<span class="hljs-string">"SELinux is not enabled for this application.\n"</span>));</span><br><span class="line">	    <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line"><span class="hljs-comment">#endif</span></span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'?'</span>:</span><br><span class="line">	    usage(E_OPTERR);</span><br><span class="line">	case <span class="hljs-string">'h'</span>:</span><br><span class="line">	    usage(E_USAGE);</span><br><span class="line">	case <span class="hljs-string">'s'</span>:</span><br><span class="line">	    flag_sta++;</span><br><span class="line">	}</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (flag_int + flag_rou + flag_mas + flag_sta > <span class="hljs-number">1</span>)</span><br><span class="line">	usage(E_OPTERR);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> ((flag_inet || flag_inet6 || flag_sta) &&</span><br><span class="line">        !(flag_tcp || flag_sctp || flag_udp || flag_udplite || flag_raw))</span><br><span class="line">	   flag_noprot = flag_tcp = flag_sctp = flag_udp = flag_udplite = flag_raw = <span class="hljs-number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> ((flag_tcp || flag_sctp || flag_udp || flag_udplite || flag_raw || flag_igmp) &&</span><br><span class="line">        !(flag_inet || flag_inet6))</span><br><span class="line">        flag_inet = flag_inet6 = <span class="hljs-number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (flag_bluetooth && !(flag_l2cap || flag_rfcomm))</span><br><span class="line">	   flag_l2cap = flag_rfcomm = <span class="hljs-number">1</span>;</span><br><span class="line"></span><br><span class="line">    flag_arg = flag_tcp + flag_sctp + flag_udplite + flag_udp + flag_raw + flag_unx</span><br><span class="line">        + flag_ipx + flag_ax25 + flag_netrom + flag_igmp + flag_x25 + flag_rose</span><br><span class="line">	+ flag_l2cap + flag_rfcomm;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (flag_mas) {</span><br><span class="line"><span class="hljs-comment">#if HAVE_FW_MASQUERADE && HAVE_AFINET</span></span><br><span class="line"><span class="hljs-comment">#if MORE_THAN_ONE_MASQ_AF</span></span><br><span class="line">	<span class="hljs-keyword">if</span> (!afname[<span class="hljs-number">0</span>])</span><br><span class="line">        safe_strncpy(afname, DFLT_AF, sizeof(afname));</span><br><span class="line"><span class="hljs-comment">#endif</span></span><br><span class="line">	<span class="hljs-keyword">for</span> (;;) {</span><br><span class="line">	    i = ip_masq_info(flag_not & FLAG_NUM_HOST,</span><br><span class="line">			     flag_not & FLAG_NUM_PORT, flag_exp);</span><br><span class="line">	    <span class="hljs-keyword">if</span> (i || !flag_cnt)</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line">	    wait_continous();</span><br><span class="line">	}</span><br><span class="line"><span class="hljs-comment">#else</span></span><br><span class="line">	ENOSUPP(<span class="hljs-string">"netstat"</span>, <span class="hljs-string">"FW_MASQUERADE"</span>);</span><br><span class="line">	i = -<span class="hljs-number">1</span>;</span><br><span class="line"><span class="hljs-comment">#endif</span></span><br><span class="line">	return (i);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (flag_sta) {</span><br><span class="line">        <span class="hljs-keyword">if</span> (!afname[<span class="hljs-number">0</span>])</span><br><span class="line">            safe_strncpy(afname, DFLT_AF, sizeof(afname));</span><br><span class="line"></span><br><span class="line">        <span class="hljs-keyword">if</span> (!strcmp(afname, <span class="hljs-string">"inet"</span>)) {</span><br><span class="line"><span class="hljs-comment">#if HAVE_AFINET</span></span><br><span class="line">            parsesnmp(flag_raw, flag_tcp, flag_udp, flag_sctp);</span><br><span class="line"><span class="hljs-comment">#else</span></span><br><span class="line">            ENOSUPP(<span class="hljs-string">"netstat"</span>, <span class="hljs-string">"AF INET"</span>);</span><br><span class="line"><span class="hljs-comment">#endif</span></span><br><span class="line">        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span>(!strcmp(afname, <span class="hljs-string">"inet6"</span>)) {</span><br><span class="line"><span class="hljs-comment">#if HAVE_AFINET6</span></span><br><span class="line">            parsesnmp6(flag_raw, flag_tcp, flag_udp);</span><br><span class="line"><span class="hljs-comment">#else</span></span><br><span class="line">            ENOSUPP(<span class="hljs-string">"netstat"</span>, <span class="hljs-string">"AF INET6"</span>);</span><br><span class="line"><span class="hljs-comment">#endif</span></span><br><span class="line">        } <span class="hljs-keyword">else</span> {</span><br><span class="line">          printf(_(<span class="hljs-string">"netstat: No statistics support for specified address family: %s\n"</span>), afname);</span><br><span class="line">          <span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">        }</span><br><span class="line">        <span class="hljs-keyword">exit</span>(<span class="hljs-number">0</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (flag_rou) {</span><br><span class="line">	int options = <span class="hljs-number">0</span>;</span><br><span class="line"></span><br><span class="line">	<span class="hljs-keyword">if</span> (!afname[<span class="hljs-number">0</span>])</span><br><span class="line">        safe_strncpy(afname, DFLT_AF, sizeof(afname));</span><br><span class="line"></span><br><span class="line">	<span class="hljs-keyword">if</span> (flag_exp == <span class="hljs-number">2</span>)</span><br><span class="line">	    flag_exp = <span class="hljs-number">1</span>;</span><br><span class="line">	<span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (flag_exp == <span class="hljs-number">1</span>)</span><br><span class="line">	    flag_exp = <span class="hljs-number">2</span>;</span><br><span class="line"></span><br><span class="line">	options = (flag_exp & FLAG_EXT) | flag_not | flag_cf | flag_ver;</span><br><span class="line">	<span class="hljs-keyword">if</span> (!flag_cf)</span><br><span class="line">	    options |= FLAG_FIB;</span><br><span class="line"></span><br><span class="line">	<span class="hljs-keyword">for</span> (;;) {</span><br><span class="line">	    i = route_info(afname, options);</span><br><span class="line">	    <span class="hljs-keyword">if</span> (i || !flag_cnt)</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line">            wait_continous();</span><br><span class="line">	}</span><br><span class="line">	return (i);</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">if</span> (flag_int) {</span><br><span class="line">	<span class="hljs-keyword">for</span> (;;) {</span><br><span class="line">	    i = iface_info();</span><br><span class="line">	    <span class="hljs-keyword">if</span> (!flag_cnt || i)</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line">            wait_continous();</span><br><span class="line">	}</span><br><span class="line">	return (i);</span><br><span class="line">    }</span><br></pre></td></tr></tbody></table></figure>

<p><strong>prg_cache_load</strong></p>
<figure class="highlight maxima hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">#<span class="hljs-keyword">if</span> HAVE_AFINET</span><br><span class="line">	    prg_cache_load();</span><br><span class="line">	    <span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">"Active Internet connections "</span>));	<span class="hljs-comment">/* xxx */</span></span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">if</span> (flag_all)</span><br><span class="line">		<span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">"(servers and established)"</span>));</span><br><span class="line">	    <span class="hljs-keyword">else</span> {</span><br><span class="line">	      <span class="hljs-keyword">if</span> (flag_lst)</span><br><span class="line">		<span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">"(only servers)"</span>));</span><br><span class="line">	      <span class="hljs-keyword">else</span></span><br><span class="line">		<span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">"(w/o servers)"</span>));</span><br><span class="line">	    }</span><br><span class="line">	    <span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">"\nProto Recv-Q Send-Q Local Address           Foreign Address         State      "</span>));	<span class="hljs-comment">/* xxx */</span></span><br><span class="line">	    <span class="hljs-keyword">if</span> (flag_exp > <span class="hljs-number">1</span>)</span><br><span class="line">		<span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">" User       Inode     "</span>));</span><br><span class="line">	    print_progname_banner();</span><br><span class="line">	    print_selinux_banner();</span><br><span class="line">	    <span class="hljs-keyword">if</span> (flag_opt)</span><br><span class="line">		<span class="hljs-built_in">printf</span>(<span class="hljs-symbol">_</span>(<span class="hljs-string">" Timer"</span>));	<span class="hljs-comment">/* xxx */</span></span><br><span class="line">	    <span class="hljs-built_in">printf</span>(<span class="hljs-string">"\n"</span>);</span><br><span class="line">#<span class="hljs-keyword">else</span></span><br><span class="line">	    <span class="hljs-keyword">if</span> (flag_arg) {</span><br><span class="line">		i = <span class="hljs-number">1</span>;</span><br><span class="line">		ENOSUPP(<span class="hljs-string">"netstat"</span>, <span class="hljs-string">"AF INET"</span>);</span><br><span class="line">	    }</span><br><span class="line">#endif</span><br></pre></td></tr></tbody></table></figure>

<p>​    2286行之后，首先需要引起注意的是<code>#if HAVE_AFINET</code>这句判断，需要了解的是，socket套接字协议类型是种类繁多的，官方将不同种类和功能的socket根据协议分类到不同的socket协议族中，如AF_BLUETOOTH、AF_NETLINK、AF_INET、AF_INET6等，这些不同协议族中的socket有的是用于进程间通信，有的是用于和硬件通信，有的是用于网络通信等等，不同类型功能各不相同，所以需要分类去显示，<code>#if HAVE_AFINET</code>也就是用于netstat去分类显示用的。</p>
<p>​    其次比较重要的是prg_cache_load这个函数，先贴下</p>
<figure class="highlight arduino hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">prg_cache_load</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    <span class="hljs-keyword">char</span> <span class="hljs-built_in">line</span>[LINE_MAX], eacces=<span class="hljs-number">0</span>;</span><br><span class="line">    <span class="hljs-keyword">int</span> procfdlen, fd, cmdllen, lnamelen;</span><br><span class="line">    <span class="hljs-keyword">char</span> lname[<span class="hljs-number">30</span>], cmdlbuf[<span class="hljs-number">512</span>], finbuf[PROGNAME_WIDTH];</span><br><span class="line">    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> inode;</span><br><span class="line">    <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *cs, *cmdlp;</span><br><span class="line">    DIR *dirproc = <span class="hljs-literal">NULL</span>, *dirfd = <span class="hljs-literal">NULL</span>;</span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">dirent</span> *<span class="hljs-title">direproc</span>, *<span class="hljs-title">direfd</span>;</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> HAVE_SELINUX</span></span><br><span class="line">    <span class="hljs-keyword">security_context_t</span> scon = <span class="hljs-literal">NULL</span>;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (prg_cache_loaded || !flag_prg) <span class="hljs-keyword">return</span>;</span><br><span class="line">    prg_cache_loaded = <span class="hljs-number">1</span>;</span><br><span class="line">    cmdlbuf[<span class="hljs-keyword">sizeof</span>(cmdlbuf) - <span class="hljs-number">1</span>] = <span class="hljs-string">'\0'</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (!(dirproc=opendir(PATH_PROC))) <span class="hljs-keyword">goto</span> fail;</span><br><span class="line">    <span class="hljs-keyword">while</span> (errno = <span class="hljs-number">0</span>, direproc = readdir(dirproc)) {</span><br><span class="line">	<span class="hljs-keyword">for</span> (cs = direproc->d_name; *cs; cs++)</span><br><span class="line">	    <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isdigit</span>(*cs))</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line">	<span class="hljs-keyword">if</span> (*cs)</span><br><span class="line">	    <span class="hljs-keyword">continue</span>;</span><br><span class="line">	procfdlen = <span class="hljs-built_in">snprintf</span>(<span class="hljs-built_in">line</span>,<span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">line</span>),PATH_PROC_X_FD,direproc->d_name);</span><br><span class="line">	<span class="hljs-keyword">if</span> (procfdlen <= <span class="hljs-number">0</span> || procfdlen >= <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">line</span>) - <span class="hljs-number">5</span>)</span><br><span class="line">	    <span class="hljs-keyword">continue</span>;</span><br><span class="line">	errno = <span class="hljs-number">0</span>;</span><br><span class="line">	dirfd = opendir(<span class="hljs-built_in">line</span>);</span><br><span class="line">	<span class="hljs-keyword">if</span> (! dirfd) {</span><br><span class="line">	    <span class="hljs-keyword">if</span> (errno == EACCES)</span><br><span class="line">		eacces = <span class="hljs-number">1</span>;</span><br><span class="line">	    <span class="hljs-keyword">continue</span>;</span><br><span class="line">	}</span><br><span class="line">	<span class="hljs-built_in">line</span>[procfdlen] = <span class="hljs-string">'/'</span>;</span><br><span class="line">	cmdlp = <span class="hljs-literal">NULL</span>;</span><br><span class="line">	<span class="hljs-keyword">while</span> ((direfd = readdir(dirfd))) {</span><br><span class="line">           <span class="hljs-comment">/* Skip . and .. */</span></span><br><span class="line">           <span class="hljs-keyword">if</span> (!<span class="hljs-built_in">isdigit</span>(direfd->d_name[<span class="hljs-number">0</span>]))</span><br><span class="line">               <span class="hljs-keyword">continue</span>;</span><br><span class="line">	    <span class="hljs-keyword">if</span> (procfdlen + <span class="hljs-number">1</span> + <span class="hljs-built_in">strlen</span>(direfd->d_name) + <span class="hljs-number">1</span> > <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">line</span>))</span><br><span class="line">		<span class="hljs-keyword">continue</span>;</span><br><span class="line">	    <span class="hljs-built_in">memcpy</span>(<span class="hljs-built_in">line</span> + procfdlen - PATH_FD_SUFFl, PATH_FD_SUFF <span class="hljs-string">"/"</span>,</span><br><span class="line">		   PATH_FD_SUFFl + <span class="hljs-number">1</span>);</span><br><span class="line">        safe_strncpy(<span class="hljs-built_in">line</span> + procfdlen + <span class="hljs-number">1</span>, direfd->d_name,</span><br><span class="line">                        <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">line</span>) - procfdlen - <span class="hljs-number">1</span>);</span><br><span class="line">	    lnamelen = readlink(<span class="hljs-built_in">line</span>, lname, <span class="hljs-keyword">sizeof</span>(lname) - <span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">if</span> (lnamelen == <span class="hljs-number">-1</span>)</span><br><span class="line">		    <span class="hljs-keyword">continue</span>;</span><br><span class="line">            lname[lnamelen] = <span class="hljs-string">'\0'</span>;  <span class="hljs-comment">/*make it a null-terminated string*/</span></span><br><span class="line"></span><br><span class="line">            <span class="hljs-keyword">if</span> (extract_type_1_socket_inode(lname, &inode) < <span class="hljs-number">0</span>)</span><br><span class="line">              <span class="hljs-keyword">if</span> (extract_type_2_socket_inode(lname, &inode) < <span class="hljs-number">0</span>)</span><br><span class="line">                <span class="hljs-keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">if</span> (!cmdlp) {</span><br><span class="line">		<span class="hljs-keyword">if</span> (procfdlen - PATH_FD_SUFFl + PATH_CMDLINEl >=</span><br><span class="line">		    <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">line</span>) - <span class="hljs-number">5</span>)</span><br><span class="line">		    <span class="hljs-keyword">continue</span>;</span><br><span class="line">        safe_strncpy(<span class="hljs-built_in">line</span> + procfdlen - PATH_FD_SUFFl, PATH_CMDLINE,</span><br><span class="line">                        <span class="hljs-keyword">sizeof</span>(<span class="hljs-built_in">line</span>) - procfdlen + PATH_FD_SUFFl);</span><br><span class="line">		fd = <span class="hljs-built_in">open</span>(<span class="hljs-built_in">line</span>, O_RDONLY);</span><br><span class="line">		<span class="hljs-keyword">if</span> (fd < <span class="hljs-number">0</span>)</span><br><span class="line">		    <span class="hljs-keyword">continue</span>;</span><br><span class="line">		cmdllen = <span class="hljs-built_in">read</span>(fd, cmdlbuf, <span class="hljs-keyword">sizeof</span>(cmdlbuf) - <span class="hljs-number">1</span>);</span><br><span class="line">		<span class="hljs-keyword">if</span> (<span class="hljs-built_in">close</span>(fd))</span><br><span class="line">		    <span class="hljs-keyword">continue</span>;</span><br><span class="line">		<span class="hljs-keyword">if</span> (cmdllen == <span class="hljs-number">-1</span>)</span><br><span class="line">		    <span class="hljs-keyword">continue</span>;</span><br><span class="line">		<span class="hljs-keyword">if</span> (cmdllen < <span class="hljs-keyword">sizeof</span>(cmdlbuf) - <span class="hljs-number">1</span>)</span><br><span class="line">		    cmdlbuf[cmdllen]=<span class="hljs-string">'\0'</span>;</span><br><span class="line">		<span class="hljs-keyword">if</span> (cmdlbuf[<span class="hljs-number">0</span>] == <span class="hljs-string">'/'</span> && (cmdlp = <span class="hljs-built_in">strrchr</span>(cmdlbuf, <span class="hljs-string">'/'</span>)))</span><br><span class="line">		    cmdlp++;</span><br><span class="line">		<span class="hljs-keyword">else</span></span><br><span class="line">		    cmdlp = cmdlbuf;</span><br><span class="line">	    }</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-built_in">snprintf</span>(finbuf, <span class="hljs-keyword">sizeof</span>(finbuf), <span class="hljs-string">"%s/%s"</span>, direproc->d_name, cmdlp);</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> HAVE_SELINUX</span></span><br><span class="line">	    <span class="hljs-keyword">if</span> (getpidcon(atoi(direproc->d_name), &scon) == <span class="hljs-number">-1</span>) {</span><br><span class="line">		    scon=xstrdup(<span class="hljs-string">"-"</span>);</span><br><span class="line">	    }</span><br><span class="line">	    prg_cache_add(inode, finbuf, scon);</span><br><span class="line">	    freecon(scon);</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">else</span></span></span><br><span class="line">	    prg_cache_add(inode, finbuf, <span class="hljs-string">"-"</span>);</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></span><br><span class="line">	}</span><br><span class="line">	closedir(dirfd);</span><br><span class="line">	dirfd = <span class="hljs-literal">NULL</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">if</span> (dirproc)</span><br><span class="line">	closedir(dirproc);</span><br><span class="line">    <span class="hljs-keyword">if</span> (dirfd)</span><br><span class="line">	closedir(dirfd);</span><br><span class="line">    <span class="hljs-keyword">if</span> (!eacces)</span><br><span class="line">	<span class="hljs-keyword">return</span>;</span><br><span class="line">    <span class="hljs-keyword">if</span> (prg_cache_loaded == <span class="hljs-number">1</span>) {</span><br><span class="line">    fail:</span><br><span class="line">	<span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>,_(<span class="hljs-string">"(No info could be read for \"-p\": geteuid()=%d but you should be root.)\n"</span>),</span><br><span class="line">		geteuid());</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">else</span></span><br><span class="line">	<span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, _(<span class="hljs-string">"(Not all processes could be identified, non-owned process info\n"</span></span><br><span class="line">			 <span class="hljs-string">" will not be shown, you would have to be root to see it all.)\n"</span>));</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>​    看上去很长，其实逻辑很清晰，首先<code>if (prg_cache_loaded || !flag_prg) return;</code>一句通过判断prg_cache是否已经加载以及netstat -p参数是否置位，来决定是否进入此分支；一旦进入此分支，则利用readdir进行二次循环，第一次拿到/proc下pid，第二次解析出/proc/pid/fd下的inode以及拿到cmdline等数据；最后，利用<code>prg_cache_add(inode, finbuf, "-")</code>将解析出的inode及findbuf放入prg_node链表中，此处的finbuf是pid和cmdline的拼接，第三个参数scon为”-“，后面可知由于proc下pid具有瞬时特性，pid数据可能存在丢失，一旦netstat未解析出网络数据对应的pid，则用”-“在pid/program一栏进行代替。</p>
<p>​    看下prg_cache_add，如下，与之联动对链表进行增、查、删操作的还有prg_cache_get和prg_cache_get_con以及prg_cache_clear，一并贴下：</p>
<figure class="highlight reasonml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">static void prg<span class="hljs-constructor">_cache_add(<span class="hljs-params">unsigned</span> <span class="hljs-params">long</span> <span class="hljs-params">inode</span>, <span class="hljs-params">char</span> <span class="hljs-operator">*</span><span class="hljs-params">name</span>, <span class="hljs-params">const</span> <span class="hljs-params">char</span> <span class="hljs-operator">*</span><span class="hljs-params">scon</span>)</span></span><br><span class="line">{</span><br><span class="line">    unsigned hi = <span class="hljs-constructor">PRG_HASHIT(<span class="hljs-params">inode</span>)</span>;</span><br><span class="line">    <span class="hljs-keyword">struct</span> prg_node **pnp,*pn;</span><br><span class="line"></span><br><span class="line">    prg_cache_loaded = <span class="hljs-number">2</span>;</span><br><span class="line">    for (pnp = prg_hash + hi; (pn = *pnp); pnp = &pn->next) {</span><br><span class="line">	<span class="hljs-keyword">if</span> (pn->inode<span class="hljs-operator"> == </span>inode) {</span><br><span class="line">	    <span class="hljs-comment">/* Some warning should be appropriate here</span></span><br><span class="line"><span class="hljs-comment">	       as we got multiple processes for one i-node */</span></span><br><span class="line">	    return;</span><br><span class="line">	}</span><br><span class="line">    }</span><br><span class="line">    <span class="hljs-keyword">if</span> (!(*pnp = malloc(sizeof(**pnp))))</span><br><span class="line">	return;</span><br><span class="line">    pn = *pnp;</span><br><span class="line">    pn->next = NULL;</span><br><span class="line">    pn->inode = inode;</span><br><span class="line">    safe<span class="hljs-constructor">_strncpy(<span class="hljs-params">pn</span>-><span class="hljs-params">name</span>, <span class="hljs-params">name</span>, <span class="hljs-params">sizeof</span>(<span class="hljs-params">pn</span>-><span class="hljs-params">name</span>)</span>);</span><br><span class="line"></span><br><span class="line">    {</span><br><span class="line">	<span class="hljs-built_in">int</span> len = (strlen(scon) - sizeof(pn->scon)) + <span class="hljs-number">1</span>;</span><br><span class="line">	<span class="hljs-keyword">if</span> (len > <span class="hljs-number">0</span>)</span><br><span class="line">            safe<span class="hljs-constructor">_strncpy(<span class="hljs-params">pn</span>-><span class="hljs-params">scon</span>, &<span class="hljs-params">scon</span>[<span class="hljs-params">len</span> + 1], <span class="hljs-params">sizeof</span>(<span class="hljs-params">pn</span>-><span class="hljs-params">scon</span>)</span>);</span><br><span class="line">	<span class="hljs-keyword">else</span></span><br><span class="line">            safe<span class="hljs-constructor">_strncpy(<span class="hljs-params">pn</span>-><span class="hljs-params">scon</span>, <span class="hljs-params">scon</span>, <span class="hljs-params">sizeof</span>(<span class="hljs-params">pn</span>-><span class="hljs-params">scon</span>)</span>);</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">}</span><br><span class="line">static const <span class="hljs-built_in">char</span> *prg<span class="hljs-constructor">_cache_get(<span class="hljs-params">unsigned</span> <span class="hljs-params">long</span> <span class="hljs-params">inode</span>)</span></span><br><span class="line">{</span><br><span class="line">    unsigned hi = <span class="hljs-constructor">PRG_HASHIT(<span class="hljs-params">inode</span>)</span>;</span><br><span class="line">    <span class="hljs-keyword">struct</span> prg_node *pn;</span><br><span class="line"></span><br><span class="line">    for (pn = prg_hash<span class="hljs-literal">[<span class="hljs-identifier">hi</span>]</span>; pn; pn = pn->next)</span><br><span class="line">	<span class="hljs-keyword">if</span> (pn->inode<span class="hljs-operator"> == </span>inode)</span><br><span class="line">	    return (pn->name);</span><br><span class="line">    return (<span class="hljs-string">"-"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">static const <span class="hljs-built_in">char</span> *prg<span class="hljs-constructor">_cache_get_con(<span class="hljs-params">unsigned</span> <span class="hljs-params">long</span> <span class="hljs-params">inode</span>)</span></span><br><span class="line">{</span><br><span class="line">    unsigned hi = <span class="hljs-constructor">PRG_HASHIT(<span class="hljs-params">inode</span>)</span>;</span><br><span class="line">    <span class="hljs-keyword">struct</span> prg_node *pn;</span><br><span class="line"></span><br><span class="line">    for (pn = prg_hash<span class="hljs-literal">[<span class="hljs-identifier">hi</span>]</span>; pn; pn = pn->next)</span><br><span class="line">	<span class="hljs-keyword">if</span> (pn->inode<span class="hljs-operator"> == </span>inode)</span><br><span class="line">	    return (pn->scon);</span><br><span class="line">    return (<span class="hljs-string">"-"</span>);</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line">static void prg<span class="hljs-constructor">_cache_clear(<span class="hljs-params">void</span>)</span></span><br><span class="line">{</span><br><span class="line">    <span class="hljs-keyword">struct</span> prg_node **pnp,*pn;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (prg_cache_loaded<span class="hljs-operator"> == </span><span class="hljs-number">2</span>)</span><br><span class="line">	for (pnp = prg_hash; pnp < prg_hash + PRG_HASH_SIZE; pnp++)</span><br><span class="line">	    <span class="hljs-keyword">while</span> ((pn = *pnp)) {</span><br><span class="line">		*pnp = pn->next;</span><br><span class="line">		free(pn);</span><br><span class="line">	    }</span><br><span class="line">    prg_cache_loaded = <span class="hljs-number">0</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>tcp_info</strong></p>
<p>Prg_load之后正式进入解析流程，首先依旧是判断socket协议族类型，不同协议族进入不同分支进行处理，这边主要关注<code>HAVE_AFINET</code>协议，HAVE_AFINET协议族内部又包含不同socket类型，具体包括tcp、udp、raw_info等，此处主要分析tcp，因为流程都类似。</p>
<figure class="highlight properties hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-attr">if</span> <span class="hljs-string">HAVE_AFINET</span></span><br><span class="line">	<span class="hljs-attr">if</span> <span class="hljs-string">(!flag_arg || flag_tcp) {</span></span><br><span class="line">	    <span class="hljs-attr">i</span> = <span class="hljs-string">tcp_info();</span></span><br><span class="line">	    <span class="hljs-attr">if</span> <span class="hljs-string">(i)</span></span><br><span class="line">		<span class="hljs-attr">return</span> <span class="hljs-string">(i);</span></span><br><span class="line">	<span class="hljs-attr">}</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-attr">if</span> <span class="hljs-string">(!flag_arg || flag_sctp) {</span></span><br><span class="line">	    <span class="hljs-attr">i</span> = <span class="hljs-string">sctp_info();</span></span><br><span class="line">	    <span class="hljs-attr">if</span> <span class="hljs-string">(i)</span></span><br><span class="line">		<span class="hljs-attr">return</span> <span class="hljs-string">(i);</span></span><br><span class="line">	<span class="hljs-attr">}</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-attr">if</span> <span class="hljs-string">(!flag_arg || flag_udp) {</span></span><br><span class="line">	    <span class="hljs-attr">i</span> = <span class="hljs-string">udp_info();</span></span><br><span class="line">	    <span class="hljs-attr">if</span> <span class="hljs-string">(i)</span></span><br><span class="line">		<span class="hljs-attr">return</span> <span class="hljs-string">(i);</span></span><br><span class="line">	<span class="hljs-attr">}</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-attr">if</span> <span class="hljs-string">(!flag_arg || flag_udplite) {</span></span><br><span class="line">	    <span class="hljs-attr">i</span> = <span class="hljs-string">udplite_info();</span></span><br><span class="line">	    <span class="hljs-attr">if</span> <span class="hljs-string">(i)</span></span><br><span class="line">		<span class="hljs-attr">return</span> <span class="hljs-string">(i);</span></span><br><span class="line">	<span class="hljs-attr">}</span></span><br><span class="line"></span><br><span class="line">	<span class="hljs-attr">if</span> <span class="hljs-string">(!flag_arg || flag_raw) {</span></span><br><span class="line">	    <span class="hljs-attr">i</span> = <span class="hljs-string">raw_info();</span></span><br><span class="line">	    <span class="hljs-attr">if</span> <span class="hljs-string">(i)</span></span><br><span class="line">		<span class="hljs-attr">return</span> <span class="hljs-string">(i);</span></span><br><span class="line">	<span class="hljs-attr">}</span></span><br></pre></td></tr></tbody></table></figure>

<figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">int</span> <span class="hljs-title">tcp_info</span><span class="hljs-params">(<span class="hljs-keyword">void</span>)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    INFO_GUTS6(_PATH_PROCNET_TCP, _PATH_PROCNET_TCP6, <span class="hljs-string">"AF INET (tcp)"</span>,</span><br><span class="line">	       tcp_do_one, <span class="hljs-string">"tcp"</span>, <span class="hljs-string">"tcp6"</span>);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>tcp_info调用了<code>INFO_GUTS6</code>，INFO_GUTS6有六个参数，前两个是lib/pathnames.h中定义的宏，分表vfs下的tcp4/6存储文件：</p>
<figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _PATH_PROCNET_TCP		<span class="hljs-meta-string">"/proc/net/tcp"</span></span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> _PATH_PROCNET_TCP6		<span class="hljs-meta-string">"/proc/net/tcp6"</span></span></span><br></pre></td></tr></tbody></table></figure>

<p>剩下的tcp_do_one看上去像函数指针，猜测是在INFO_GUTS6中进行了调用，跟进<code>INFO_GUTS6</code>：</p>
<figure class="highlight reasonml hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#define <span class="hljs-constructor">INFO_GUTS6(<span class="hljs-params">file</span>,<span class="hljs-params">file6</span>,<span class="hljs-params">name</span>,<span class="hljs-params">proc</span>,<span class="hljs-params">prot4</span>,<span class="hljs-params">prot6</span>)</span>	\</span><br><span class="line"> <span class="hljs-built_in">char</span> buffer<span class="hljs-literal">[<span class="hljs-number">8192</span>]</span>;					\</span><br><span class="line"> <span class="hljs-built_in">int</span> rc = <span class="hljs-number">0</span>;						\</span><br><span class="line"> <span class="hljs-built_in">int</span> lnr = <span class="hljs-number">0</span>;						\</span><br><span class="line"> <span class="hljs-keyword">if</span> (!flag_arg<span class="hljs-operator"> || </span>flag_inet) {				\</span><br><span class="line">    <span class="hljs-constructor">INFO_GUTS1(<span class="hljs-params">file</span>,<span class="hljs-params">name</span>,<span class="hljs-params">proc</span>,<span class="hljs-params">prot4</span>)</span>			\</span><br><span class="line"> }							\</span><br><span class="line"> <span class="hljs-keyword">if</span> (!flag_arg<span class="hljs-operator"> || </span>flag_inet6) {				\</span><br><span class="line">    <span class="hljs-constructor">INFO_GUTS2(<span class="hljs-params">file6</span>,<span class="hljs-params">proc</span>,<span class="hljs-params">prot6</span>)</span>			\</span><br><span class="line"> }							\</span><br><span class="line"> INFO_GUTS3</span><br></pre></td></tr></tbody></table></figure>

<p>这边是用的宏去定义函数，可以看到其根据数据包ipv4/ipv6协议类型分设了两条分支，这边只看ipv4，进入INFO_GUTS1：</p>
<figure class="highlight livescript hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-comment">#define INFO_GUTS1(file,name,proc,prot)			\</span></span><br><span class="line">  procinfo = proc_fopen((file));			<span class="hljs-string">\</span></span><br><span class="line">  <span class="hljs-keyword">if</span> (procinfo == NULL) {				<span class="hljs-string">\</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (errno != ENOENT && errno != EACCES) {		<span class="hljs-string">\</span></span><br><span class="line">      perror((file));					<span class="hljs-string">\</span></span><br><span class="line">      <span class="hljs-keyword">return</span> -<span class="hljs-number">1</span>;					<span class="hljs-string">\</span></span><br><span class="line">    }							<span class="hljs-string">\</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (!flag_noprot && (flag_arg || flag_ver))		<span class="hljs-string">\</span></span><br><span class="line">      ESYSNOT(<span class="hljs-string">"netstat"</span>, (name));			<span class="hljs-string">\</span></span><br><span class="line">    <span class="hljs-keyword">if</span> (!flag_noprot && flag_arg)			<span class="hljs-string">\</span></span><br><span class="line">      rc = <span class="hljs-number">1</span>;						<span class="hljs-string">\</span></span><br><span class="line">  } <span class="hljs-keyword">else</span> {						<span class="hljs-string">\</span></span><br><span class="line">    <span class="hljs-keyword">do</span> {						<span class="hljs-string">\</span></span><br><span class="line">      <span class="hljs-keyword">if</span> (fgets(buffer, sizeof(buffer), procinfo))	<span class="hljs-string">\</span></span><br><span class="line">        (proc)(lnr++, buffer,prot);			<span class="hljs-string">\</span></span><br><span class="line">    } <span class="hljs-keyword">while</span> (!feof(procinfo));				<span class="hljs-string">\</span></span><br><span class="line">    fclose(procinfo);					<span class="hljs-string">\</span></span><br><span class="line">  }</span><br></pre></td></tr></tbody></table></figure>

<p>同样是一个宏，首先利用proc_fopn获取/proc/net/tcp文件句柄，然后fgets读取文件中的每一行到8192字节的buffer中，<code>(proc)(lnr++, buffer,prot);</code>调用了INFO_GUTS6传入的tcp_do_one函数指针，将/proc/net/tcp中的每一行传入作为tcp_do_one的参数进行循环处理，猜测是对buffer进行内容进行解析。</p>
<p><strong>tcp_do_one</strong></p>
<p>首先贴下代码：</p>
<figure class="highlight arduino hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">tcp_do_one</span><span class="hljs-params">(<span class="hljs-keyword">int</span> lnr, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *<span class="hljs-built_in">line</span>, <span class="hljs-keyword">const</span> <span class="hljs-keyword">char</span> *prot)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    <span class="hljs-keyword">unsigned</span> <span class="hljs-keyword">long</span> rxq, txq, time_len, retr, inode;</span><br><span class="line">    <span class="hljs-keyword">int</span> num, local_port, rem_port, d, state, uid, timer_run, timeout;</span><br><span class="line">    <span class="hljs-keyword">char</span> rem_addr[<span class="hljs-number">128</span>], local_addr[<span class="hljs-number">128</span>], timers[<span class="hljs-number">64</span>];</span><br><span class="line">    <span class="hljs-keyword">const</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aftype</span> *<span class="hljs-title">ap</span>;</span></span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_storage</span> <span class="hljs-title">localsas</span>, <span class="hljs-title">remsas</span>;</span></span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> *<span class="hljs-title">localaddr</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">sockaddr_in</span> *)&<span class="hljs-title">localsas</span>;</span></span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">sockaddr_in</span> *<span class="hljs-title">remaddr</span> = (<span class="hljs-title">struct</span> <span class="hljs-title">sockaddr_in</span> *)&<span class="hljs-title">remsas</span>;</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> HAVE_AFINET6</span></span><br><span class="line">    <span class="hljs-keyword">char</span> addr6[INET6_ADDRSTRLEN];</span><br><span class="line">    <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">in6_addr</span> <span class="hljs-title">in6</span>;</span></span><br><span class="line">    <span class="hljs-keyword">extern</span> <span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">aftype</span> <span class="hljs-title">inet6_aftype</span>;</span></span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></span><br><span class="line">    <span class="hljs-keyword">long</span> clk_tck = ticks_per_second();</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (lnr == <span class="hljs-number">0</span>)</span><br><span class="line">	<span class="hljs-keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    num = <span class="hljs-built_in">sscanf</span>(<span class="hljs-built_in">line</span>,</span><br><span class="line">    <span class="hljs-string">"%d: %64[0-9A-Fa-f]:%X %64[0-9A-Fa-f]:%X %X %lX:%lX %X:%lX %lX %d %d %lu %*s\n"</span>,</span><br><span class="line">		 &d, local_addr, &local_port, rem_addr, &rem_port, &state,</span><br><span class="line">		 &txq, &rxq, &timer_run, &time_len, &retr, &uid, &timeout, &inode);</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (num < <span class="hljs-number">11</span>) {</span><br><span class="line">	<span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, _(<span class="hljs-string">"warning, got bogus tcp line.\n"</span>));</span><br><span class="line">	<span class="hljs-keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (!flag_all && ((flag_lst && rem_port) || (!flag_lst && !rem_port)))</span><br><span class="line">      <span class="hljs-keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> (<span class="hljs-built_in">strlen</span>(local_addr) > <span class="hljs-number">8</span>) {</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> HAVE_AFINET6</span></span><br><span class="line">	<span class="hljs-comment">/* Demangle what the kernel gives us */</span></span><br><span class="line">	<span class="hljs-built_in">sscanf</span>(local_addr, <span class="hljs-string">"%08X%08X%08X%08X"</span>,</span><br><span class="line">	       &in6.s6_addr32[<span class="hljs-number">0</span>], &in6.s6_addr32[<span class="hljs-number">1</span>],</span><br><span class="line">           &in6.s6_addr32[<span class="hljs-number">2</span>], &in6.s6_addr32[<span class="hljs-number">3</span>]);</span><br><span class="line">	inet_ntop(AF_INET6, &in6, addr6, <span class="hljs-keyword">sizeof</span>(addr6));</span><br><span class="line">	inet6_aftype.input(<span class="hljs-number">1</span>, addr6, &localsas);</span><br><span class="line">	<span class="hljs-built_in">sscanf</span>(rem_addr, <span class="hljs-string">"%08X%08X%08X%08X"</span>,</span><br><span class="line">	       &in6.s6_addr32[<span class="hljs-number">0</span>], &in6.s6_addr32[<span class="hljs-number">1</span>],</span><br><span class="line">	       &in6.s6_addr32[<span class="hljs-number">2</span>], &in6.s6_addr32[<span class="hljs-number">3</span>]);</span><br><span class="line">	inet_ntop(AF_INET6, &in6, addr6, <span class="hljs-keyword">sizeof</span>(addr6));</span><br><span class="line">	inet6_aftype.input(<span class="hljs-number">1</span>, addr6, &remsas);</span><br><span class="line">	localsas.ss_family = AF_INET6;</span><br><span class="line">	remsas.ss_family = AF_INET6;</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></span><br><span class="line">    } <span class="hljs-keyword">else</span> {</span><br><span class="line">	<span class="hljs-built_in">sscanf</span>(local_addr, <span class="hljs-string">"%X"</span>, &localaddr->sin_addr.s_addr);</span><br><span class="line">	<span class="hljs-built_in">sscanf</span>(rem_addr, <span class="hljs-string">"%X"</span>, &remaddr->sin_addr.s_addr);</span><br><span class="line">	localsas.ss_family = AF_INET;</span><br><span class="line">	remsas.ss_family = AF_INET;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">    <span class="hljs-keyword">if</span> ((ap = get_afntype(localsas.ss_family)) == <span class="hljs-literal">NULL</span>) {</span><br><span class="line">	<span class="hljs-built_in">fprintf</span>(<span class="hljs-built_in">stderr</span>, _(<span class="hljs-string">"netstat: unsupported address family %d !\n"</span>),</span><br><span class="line">		localsas.ss_family);</span><br><span class="line">	<span class="hljs-keyword">return</span>;</span><br><span class="line">    }</span><br><span class="line"></span><br><span class="line">	addr_do_one(local_addr, <span class="hljs-keyword">sizeof</span>(local_addr), <span class="hljs-number">22</span>, ap, &localsas, local_port, <span class="hljs-string">"tcp"</span>);</span><br><span class="line">	addr_do_one(rem_addr, <span class="hljs-keyword">sizeof</span>(rem_addr), <span class="hljs-number">22</span>, ap, &remsas, rem_port, <span class="hljs-string">"tcp"</span>);</span><br><span class="line"></span><br><span class="line">	timers[<span class="hljs-number">0</span>] = <span class="hljs-string">'\0'</span>;</span><br><span class="line">	<span class="hljs-keyword">if</span> (flag_opt)</span><br><span class="line">	    <span class="hljs-keyword">switch</span> (timer_run) {</span><br><span class="line">	    <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:</span><br><span class="line">		<span class="hljs-built_in">snprintf</span>(timers, <span class="hljs-keyword">sizeof</span>(timers), _(<span class="hljs-string">"off (0.00/%ld/%d)"</span>), retr, timeout);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:</span><br><span class="line">		<span class="hljs-built_in">snprintf</span>(timers, <span class="hljs-keyword">sizeof</span>(timers), _(<span class="hljs-string">"on (%2.2f/%ld/%d)"</span>),</span><br><span class="line">			 (<span class="hljs-keyword">double</span>) time_len / clk_tck, retr, timeout);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:</span><br><span class="line">		<span class="hljs-built_in">snprintf</span>(timers, <span class="hljs-keyword">sizeof</span>(timers), _(<span class="hljs-string">"keepalive (%2.2f/%ld/%d)"</span>),</span><br><span class="line">			 (<span class="hljs-keyword">double</span>) time_len / clk_tck, retr, timeout);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:</span><br><span class="line">		<span class="hljs-built_in">snprintf</span>(timers, <span class="hljs-keyword">sizeof</span>(timers), _(<span class="hljs-string">"timewait (%2.2f/%ld/%d)"</span>),</span><br><span class="line">			 (<span class="hljs-keyword">double</span>) time_len / clk_tck, retr, timeout);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">case</span> <span class="hljs-number">4</span>:</span><br><span class="line">		<span class="hljs-built_in">snprintf</span>(timers, <span class="hljs-keyword">sizeof</span>(timers), _(<span class="hljs-string">"probe (%2.2f/%ld/%d)"</span>),</span><br><span class="line">			 (<span class="hljs-keyword">double</span>) time_len / clk_tck, retr, timeout);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	    <span class="hljs-keyword">default</span>:</span><br><span class="line">		<span class="hljs-built_in">snprintf</span>(timers, <span class="hljs-keyword">sizeof</span>(timers), _(<span class="hljs-string">"unkn-%d (%2.2f/%ld/%d)"</span>),</span><br><span class="line">			 timer_run, (<span class="hljs-keyword">double</span>) time_len / clk_tck, retr, timeout);</span><br><span class="line">		<span class="hljs-keyword">break</span>;</span><br><span class="line">	    }</span><br><span class="line"></span><br><span class="line">	<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%-4s  %6ld %6ld %-*s %-*s %-11s"</span>,</span><br><span class="line">	       prot, rxq, txq, (<span class="hljs-keyword">int</span>)netmax(<span class="hljs-number">23</span>,<span class="hljs-built_in">strlen</span>(local_addr)), local_addr, (<span class="hljs-keyword">int</span>)netmax(<span class="hljs-number">23</span>,<span class="hljs-built_in">strlen</span>(rem_addr)), rem_addr, _(tcp_state[state]));</span><br><span class="line"></span><br><span class="line">	finish_this_one(uid,inode,timers);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>几个点，首先解析/proc/net/tcp文件中的每一行数据，将每个字段的数据赋值到不同变量：</p>
<figure class="highlight perl hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">num = sscanf(line,<span class="hljs-string">"%d: %64[0-9A-Fa-f]:%X %64[0-9A-Fa-f]:%X %X %lX:%lX %X:%lX %lX %d %d %lu %*s\n"</span>,</span><br><span class="line">&d, local_addr, &local_port, rem_addr, &rem_port, &<span class="hljs-keyword">state</span>,</span><br><span class="line">&txq, &rxq, &timer_run, &time_len, &retr, &uid, &timeout, &inode);</span><br></pre></td></tr></tbody></table></figure>

<p>其次针对local/remote address进行解析，将解析出的字符数组转为hex整形数据：</p>
<figure class="highlight lisp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sscanf(<span class="hljs-name">local_addr</span>, <span class="hljs-string">"%X"</span>, <span class="hljs-symbol">&localaddr->sin_addr</span>.s_addr)<span class="hljs-comment">;</span></span><br><span class="line">sscanf(<span class="hljs-name">rem_addr</span>, <span class="hljs-string">"%X"</span>, <span class="hljs-symbol">&remaddr->sin_addr</span>.s_addr)<span class="hljs-comment">;</span></span><br></pre></td></tr></tbody></table></figure>

<p>再之后，adore_do_one函数，对addr及port进行操作：</p>
<figure class="highlight lisp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">addr_do_one(<span class="hljs-name">local_addr</span>, sizeof(<span class="hljs-name">local_addr</span>), <span class="hljs-number">22</span>, ap, <span class="hljs-symbol">&localsas</span>, local_port, <span class="hljs-string">"tcp"</span>)<span class="hljs-comment">;</span></span><br><span class="line">addr_do_one(<span class="hljs-name">rem_addr</span>, sizeof(<span class="hljs-name">rem_addr</span>), <span class="hljs-number">22</span>, ap, <span class="hljs-symbol">&remsas</span>, rem_port, <span class="hljs-string">"tcp"</span>)<span class="hljs-comment">;</span></span><br></pre></td></tr></tbody></table></figure>

<p>跟进：</p>
<figure class="highlight armasm hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-symbol">static</span> void <span class="hljs-keyword">addr_do_one(char </span>*<span class="hljs-keyword">buf, </span>size_t <span class="hljs-keyword">buf_len, </span>size_t short_len, const <span class="hljs-keyword">struct </span>aftype *ap,</span><br><span class="line">			const <span class="hljs-keyword">struct </span>sockaddr_storage *<span class="hljs-keyword">addr,</span></span><br><span class="line"><span class="hljs-keyword">	</span>		int port, const char *proto</span><br><span class="line">)</span><br><span class="line">{</span><br><span class="line">    const char *sport, *<span class="hljs-keyword">saddr;</span></span><br><span class="line"><span class="hljs-keyword"> </span>   size_t port_len, <span class="hljs-keyword">addr_len;</span></span><br><span class="line"><span class="hljs-keyword"></span></span><br><span class="line"><span class="hljs-keyword"> </span>   <span class="hljs-keyword">saddr </span>= ap->sprint(<span class="hljs-keyword">addr, </span>flag_not & FLAG_NUM_HOST)<span class="hljs-comment">;</span></span><br><span class="line">    sport = get_sname(htons(port), proto, flag_not & FLAG_NUM_PORT)<span class="hljs-comment">;</span></span><br><span class="line">    <span class="hljs-keyword">addr_len </span>= <span class="hljs-keyword">strlen(saddr);</span></span><br><span class="line"><span class="hljs-keyword"> </span>   port_len = <span class="hljs-keyword">strlen(sport);</span></span><br><span class="line"><span class="hljs-keyword"> </span>   <span class="hljs-meta">if</span> (!flag_wide && (<span class="hljs-keyword">addr_len </span>+ port_len > short_len)) {</span><br><span class="line">	<span class="hljs-comment">/* Assume port name is short */</span></span><br><span class="line">	port_len = netmin(port_len, short_len - <span class="hljs-number">4</span>)<span class="hljs-comment">;</span></span><br><span class="line">	<span class="hljs-keyword">addr_len </span>= short_len - port_len<span class="hljs-comment">;</span></span><br><span class="line">	<span class="hljs-keyword">strncpy(buf, </span><span class="hljs-keyword">saddr, </span><span class="hljs-keyword">addr_len);</span></span><br><span class="line"><span class="hljs-keyword">	</span><span class="hljs-keyword">buf[addr_len] </span>= <span class="hljs-string">'\0'</span><span class="hljs-comment">;</span></span><br><span class="line">	<span class="hljs-keyword">strcat(buf, </span><span class="hljs-string">":"</span>)<span class="hljs-comment">;</span></span><br><span class="line">	<span class="hljs-keyword">strncat(buf, </span>sport, port_len)<span class="hljs-comment">;</span></span><br><span class="line">    } <span class="hljs-meta">else</span></span><br><span class="line">	snprintf(<span class="hljs-keyword">buf, </span><span class="hljs-keyword">buf_len, </span><span class="hljs-string">"%s:%s"</span>, <span class="hljs-keyword">saddr, </span>sport)<span class="hljs-comment">;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>发现其addr和port进行拼接，比较有意思的一点是利用short_len对addr和port拼接后的长度进行限制，若长度超过23，则对addr进行截断显示。</p>
<p>最后对addr:port拼接后的数据及前面在/proc/net/tcp中解析出的字段进行输出：</p>
<figure class="highlight lisp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">printf(<span class="hljs-string">"%-4s  %6ld %6ld %-*s %-*s %-11s"</span>,prot, rxq, txq, (<span class="hljs-name">int</span>)netmax(<span class="hljs-number">23</span>,strlen(<span class="hljs-name">local_addr</span>)), local_addr, (<span class="hljs-name">int</span>)netmax(<span class="hljs-number">23</span>,strlen(<span class="hljs-name">rem_addr</span>)), rem_addr, _(<span class="hljs-name">tcp_state</span>[state]))<span class="hljs-comment">;</span></span><br></pre></td></tr></tbody></table></figure>

<p>剩下的最后一个 <code>finish_this_one</code>函数，跟进分析后发现其主要是在以上的基础输出外检测变量是否置位，即参数使用情况来输出指定类型的数据栏目：</p>
<figure class="highlight lisp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">static void finish_this_one(<span class="hljs-name">int</span> uid, unsigned long inode, const char *timers)</span><br><span class="line">{</span><br><span class="line">    struct passwd *pw<span class="hljs-comment">;</span></span><br><span class="line"></span><br><span class="line">    if (<span class="hljs-name">flag_exp</span> > <span class="hljs-number">1</span>) {</span><br><span class="line">	if (!(<span class="hljs-name">flag_not</span> & FLAG_NUM_USER) <span class="hljs-symbol">&&</span> ((<span class="hljs-name">pw</span> = getpwuid(<span class="hljs-name">uid</span>)) != NULL))</span><br><span class="line">	    printf(<span class="hljs-string">" %-10s "</span>, pw->pw_name)<span class="hljs-comment">;</span></span><br><span class="line">	else</span><br><span class="line">	    printf(<span class="hljs-string">" %-10d "</span>, uid)<span class="hljs-comment">;</span></span><br><span class="line">	printf(<span class="hljs-string">"%-10lu"</span>,inode)<span class="hljs-comment">;</span></span><br><span class="line">    }</span><br><span class="line">    if (<span class="hljs-name">flag_prg</span>)</span><br><span class="line">	printf(<span class="hljs-string">" %-"</span> PROGNAME_WIDTHs <span class="hljs-string">"s"</span>,prg_cache_get(<span class="hljs-name">inode</span>))<span class="hljs-comment">;</span></span><br><span class="line">    if (<span class="hljs-name">flag_selinux</span>)</span><br><span class="line">	printf(<span class="hljs-string">" %-"</span> SELINUX_WIDTHs <span class="hljs-string">"s"</span>,prg_cache_get_con(<span class="hljs-name">inode</span>))<span class="hljs-comment">;</span></span><br><span class="line"></span><br><span class="line">    if (<span class="hljs-name">flag_opt</span>)</span><br><span class="line">	printf(<span class="hljs-string">" %s"</span>, timers)<span class="hljs-comment">;</span></span><br><span class="line">    putchar('\n')<span class="hljs-comment">;</span></span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p>其中flag_exp、flag_prg、flag_selinux、flag_opt分别对应-e、-p、-Z、-o：</p>
<figure class="highlight awk hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line">	case <span class="hljs-string">'A'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(optarg))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'M'</span>:</span><br><span class="line">	    flag_mas++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'a'</span>:</span><br><span class="line">	    flag_all++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'l'</span>:</span><br><span class="line">	    flag_lst++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'c'</span>:</span><br><span class="line">	    flag_cnt++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line"></span><br><span class="line">	case <span class="hljs-string">'d'</span>:</span><br><span class="line">	    flag_deb++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'g'</span>:</span><br><span class="line">	    flag_igmp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'e'</span>:</span><br><span class="line">	    flag_exp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'p'</span>:</span><br><span class="line">	    flag_prg++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'i'</span>:</span><br><span class="line">	    flag_int++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'W'</span>:</span><br><span class="line">	    flag_wide++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'n'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'!'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM_HOST;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'@'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM_PORT;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'#'</span>:</span><br><span class="line">	    flag_not |= FLAG_NUM_USER;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'N'</span>:</span><br><span class="line">	    flag_not |= FLAG_SYM;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'C'</span>:</span><br><span class="line">	    flag_cf |= FLAG_CACHE;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'F'</span>:</span><br><span class="line">	    flag_cf |= FLAG_FIB;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'o'</span>:</span><br><span class="line">	    flag_opt++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'6'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(<span class="hljs-string">"inet6"</span>))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'4'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(<span class="hljs-string">"inet"</span>))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'V'</span>:</span><br><span class="line">	    version();</span><br><span class="line">	    <span class="hljs-regexp">/*NOTREACHED */</span></span><br><span class="line">	case <span class="hljs-string">'v'</span>:</span><br><span class="line">	    flag_ver |= FLAG_VERBOSE;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'r'</span>:</span><br><span class="line">	    flag_rou++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'t'</span>:</span><br><span class="line">	    flag_tcp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'S'</span>:</span><br><span class="line">	    flag_sctp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'u'</span>:</span><br><span class="line">	    flag_udp++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">        case <span class="hljs-string">'U'</span>:</span><br><span class="line">	    flag_udplite++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'w'</span>:</span><br><span class="line">	    flag_raw++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">        case <span class="hljs-string">'2'</span>:</span><br><span class="line">	    flag_l2cap++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">        case <span class="hljs-string">'f'</span>:</span><br><span class="line">	    flag_rfcomm++;</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'x'</span>:</span><br><span class="line">	    <span class="hljs-keyword">if</span> (aftrans_opt(<span class="hljs-string">"unix"</span>))</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    <span class="hljs-keyword">break</span>;</span><br><span class="line">	case <span class="hljs-string">'Z'</span>:</span><br><span class="line"><span class="hljs-comment">#if HAVE_SELINUX</span></span><br><span class="line">	    <span class="hljs-keyword">if</span> (is_selinux_enabled() <= <span class="hljs-number">0</span>) {</span><br><span class="line">		fprintf(stderr, _(<span class="hljs-string">"SELinux is not enabled on this machine.\n"</span>));</span><br><span class="line">		<span class="hljs-keyword">exit</span>(<span class="hljs-number">1</span>);</span><br><span class="line">	    }</span><br><span class="line">	    flag_prg++;</span><br><span class="line">	    flag_selinux++;</span><br></pre></td></tr></tbody></table></figure>

<p>具体参数对应含义：</p>
<figure class="highlight cpp hljs"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">usage</span><span class="hljs-params">(<span class="hljs-keyword">int</span> rc)</span></span></span><br><span class="line"><span class="hljs-function"></span>{</span><br><span class="line">    FILE *fp = rc ? <span class="hljs-built_in">stderr</span> : <span class="hljs-built_in">stdout</span>;</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"usage: netstat [-vWeenNcCF] [<Af>] -r         netstat {-V|--version|-h|--help}\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"       netstat [-vWnNcaeol] [<Socket> ...]\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"       netstat { [-vWeenNac] -i | [-cnNe] -M | -s [-6tuw] }\n\n"</span>));</span><br><span class="line"></span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -r, --route              display routing table\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -i, --interfaces         display interface table\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -g, --groups             display multicast group memberships\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -s, --statistics         display networking statistics (like SNMP)\n"</span>));</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> HAVE_FW_MASQUERADE</span></span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -M, --masquerade         display masqueraded connections\n\n"</span>));</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -v, --verbose            be verbose\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -W, --wide               don't truncate IP addresses\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -n, --numeric            don't resolve names\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        --numeric-hosts          don't resolve host names\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        --numeric-ports          don't resolve port names\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        --numeric-users          don't resolve user names\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -N, --symbolic           resolve hardware names\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -e, --extend             display other/more information\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -p, --programs           display PID/Program name for sockets\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -o, --timers             display timers\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -c, --continuous         continuous listing\n\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -l, --listening          display listening server sockets\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -a, --all                display all sockets (default: connected)\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -F, --fib                display Forwarding Information Base (default)\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -C, --cache              display routing cache instead of FIB\n"</span>));</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">if</span> HAVE_SELINUX</span></span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"        -Z, --context            display SELinux security context for sockets\n"</span>));</span><br><span class="line"><span class="hljs-meta">#<span class="hljs-meta-keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"\n  <Socket>={-t|--tcp} {-u|--udp} {-U|--udplite} {-S|--sctp} {-w|--raw}\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"           {-x|--unix} --ax25 --ipx --netrom\n"</span>));</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"  <AF>=Use '-6|-4' or '-A <af>' or '--<af>'; default: %s\n"</span>), DFLT_AF);</span><br><span class="line">    <span class="hljs-built_in">fprintf</span>(fp, _(<span class="hljs-string">"  List of possible address families (which support routing):\n"</span>));</span><br><span class="line">    print_aflist(<span class="hljs-number">1</span>); <span class="hljs-comment">/* 1 = routeable */</span></span><br><span class="line">    <span class="hljs-built_in">exit</span>(rc);</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>

<p><strong>else</strong></p>
<p>剩下的就是af_inet协议族下其它类型的socket解析及输出以及其它协议族的解析输出，类似tcp_info，尾部使用prg_cache_clear清理缓存链表，不再赘述。</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>​    代码逻辑是非常清晰的，但是调试过程中发现mac下的ide的debug功能实在不是太友好，无法查看/修改整块的内存，数据的显示也和其本身格式不一致，以及单步过程中遇到了可视化界面中的光标位置和真实elf执行流程不匹配的问题，总体下来，感觉不是很灵活的样子，不止是vscode，clion也有这种问题；</p>
<p>​    正如spoock师傅所说的，netstat工具在网络进程频繁开关socket通道的环境中性能压力是很大的，联想到之前写的网络日志采集demo中有模块是复用了部分netstat源码，但是总体效果不是非常好，原因无他，遍历proc这块的io性能压力比较大，若放到实际业务环境中，如openstack这种大流量和进程频繁操作的云环境，业务影响之大可想而知；</p>
<p>​    </p>
</body></html>
        </div>
        
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-08-09</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-08-09T16:53:47.917Z">2020-08-10</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/Rootkit-HIDS/">Rootkit, HIDS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    6 分钟 读完 (大约 966 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/08/09/rootkit-sys-call-table-hook-learning/">rootkit sys_call_table hook learning</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>rootkit通常是指攻击者拿到root权限以后在行为这块做隐藏的恶意软件，其工作环境包括用户态和内核态，用户态的手法一般是通过ld_preload hook glibc，内核态则是写lkm去hook系统调用。hook系统调用技术其实也有细分，包括kernel inline hook、kprobe、sys_call_table hook等，这篇博客所记录的就是最基础的sys_call_table hook这块的内容。</p>
<h2 id="研究过程"><a href="#研究过程" class="headerlink" title="研究过程"></a>研究过程</h2><h3 id="sys-call-table-modify"><a href="#sys-call-table-modify" class="headerlink" title="sys_call_table modify"></a>sys_call_table modify</h3><p><strong>sys_call_table地址获取</strong></p>
<p>sys_call_table地址获取方式有如下几种：</p>
<p>1、从/boot/System.map中获取</p>
<p>2、从/proc/kallsyms中获取</p>
<p>3、idt劫持</p>
<p>4、暴力搜索</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/08/09/rootkit-sys-call-table-hook-learning/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-08-02</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-08-09T13:54:08.043Z">2020-08-09</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    13 分钟 读完 (大约 1878 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/08/02/Libpcap%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/">Libpcap性能问题总结</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h2><p>在进程网络日志捕获的技术选型这块的当初想了很久，备选方案有如下几种：<br>1、cn_proc<br>2、proc遍历<br>3、netfilter<br>4、auditd<br>5、libpcap<br>综合考虑得出利弊如下：<br>1、cn_proc用进程回调代替网络回调，只能抓到进程创建后立即产生网络连接的日志，对于具有潜伏特性或多线程发包的进程这种方式会存在大量漏报；<br>2、遍历/proc/net/tcp(6)，只能拿到inode，要做进程关联需要去做二次遍历，cpu消耗较大，走调度的话则会漏掉很多数据，无法做稍细的检测，不优雅；<br>3、netfilter是内核提供的机制，但调研显示不同系统的内核函数具有较大差异，需要做适配，且其hook内核tcp协议栈在大流量环境下会有一定性能影响，但比较好的一点是可以拿到数据包的关联进程信息，不用做二次遍历；<br>4、auditd同样是内核提供的机制，稳定是其一个优点，但由于是对所有内核系统调用去做过滤，不可避免对内核的负载会较高。<br>5、libpcap底层基于bpf，稳定是一个特点，但也同样存在无法执行关联进程、性能影响较大的问题。<br>因为曾经用到过libpcap，且在其性能问题上踩过坑，这边对libpcap的性能问题做下总结。</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/08/02/Libpcap%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-08-02</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-08-01T20:31:18.590Z">2020-08-02</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 分钟 读完 (大约 1718 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/08/02/%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E7%9A%84%E4%BD%93%E7%B3%BB%E5%8C%96%E6%A3%80%E6%B5%8B%E6%B5%81%E7%A8%8B/">挖矿病毒的体系化检测流程</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="一、背景"><a href="#一、背景" class="headerlink" title="一、背景"></a>一、背景</h2><p>hw前面试的时候被问到这个问题，自我感觉回答的挺凌乱的，明明这块的经验也很多，但感觉自己做的还是不够好，缺少体系化的整理和思考，这边简单做下记录，顺带着理一下思路。</p>
<h2 id="二、入侵检测"><a href="#二、入侵检测" class="headerlink" title="二、入侵检测"></a>二、入侵检测</h2><p>挖矿的直接特征相对僵木蠕来说比较单一和容易排查，即较高的CPU占用；当然也存在一些特意控制CPU不超过指定阈值的挖矿病毒，其经常出现在攻击者已经拿下域控之后的利用场景，这种你好我也好的挖矿方式相对比较隐蔽，特别是在拥有较大规模主机集群的内网中，这种挖矿很难引起管理员注意，也就不容易去排查，但需要注明的是其使用的入侵、挖矿等手段和前一种几乎是一样的，只是稍温和一点，一旦发现了异常，后续的检测也是一样的。<br>首先定位到异常主机，观察命令操作是否卡顿，查看CPU状态是否远超正常主机，若cpu资源占用高居不下，则有可能是中挖矿了；此时看下crontab里是否有被写连接未知服务器下载文件并执行的操作，若是，则90%以上是中挖矿了，之后进行溯源，主要对其入侵方式、恶意行为等进行整理，说白了就是检测怎么进来的，进来后干了什么，主要是这两个过程。</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/08/02/%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E7%9A%84%E4%BD%93%E7%B3%BB%E5%8C%96%E6%A3%80%E6%B5%8B%E6%B5%81%E7%A8%8B/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-07-07</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-07-06T17:39:14.416Z">2020-07-07</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/%E6%80%BB%E7%BB%93/">总结</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    11 分钟 读完 (大约 1680 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/07/07/%E5%85%B3%E4%BA%8E%E6%AF%95%E4%B8%9A%E5%85%A5%E8%81%8C%E5%90%8E%E7%9A%84%E6%96%B0%E8%A7%84%E5%88%92/">关于毕业入职后的新规划</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><p>四年时间转瞬即逝，转眼间，那个刚入大学校门还蹦蹦跳跳的自己，已经正式脱离学校这座象牙塔，正式步入社会了。<br>以后的生活可能就更是全量的职场生活了，尽管整个大四一直是在实习；这边记录下入职以后的新规划，来帮助自己在职场上获得更快的成长。<br>这边的规划主要集中在三个大方面，包括生活、工作和未来，其中涵盖各个小方面，不再细述。</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/07/07/%E5%85%B3%E4%BA%8E%E6%AF%95%E4%B8%9A%E5%85%A5%E8%81%8C%E5%90%8E%E7%9A%84%E6%96%B0%E8%A7%84%E5%88%92/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-07-06</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-07-06T16:17:54.971Z">2020-07-07</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分钟 读完 (大约 1122 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/07/06/Clion%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/">Clion源码调试问题记录</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h1 id="一、make-amp-amp-Makefile"><a href="#一、make-amp-amp-Makefile" class="headerlink" title="一、make && Makefile"></a>一、make && Makefile</h1><p>在相对比较大的项目中，项目通常会被模块化，使用make和makefile有助于简明的记录各个模块之间的复杂引用关系；如此之多的源文件，如果每次编译都要去敲gcc指定源文件和头文件以及链接库进行编译的确是个灾难；针对上面的问题，make应运而生。make根据makefile中定义的编译方式进行自动化的、定制化的编译，且能灵活地只对makefile中上次修改的部分进行重编译。</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/07/06/Clion%E6%BA%90%E7%A0%81%E8%B0%83%E8%AF%95%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2020-07-06</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-07-06T05:19:50.522Z">2020-07-06</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    19 分钟 读完 (大约 2789 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2020/07/06/Linux-ptrace-so%E5%BA%93%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90/">Linux ptrace so库注入分析</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>hw期间需要准备红队不同生命周期中使用的工具，作为一名二进制选手（伪），理所应当的承担起了主机层内网权限维持这块的工作输出，包括手法、自动化工具（开源、自写）、rootkit、多版本适配的魔改系统so等等。整理的过程也是学习的过程，这里打算分三部分进行记录，主要包括ptrace注入、预加载、rootkit三块。以下首先进行的是ptrace注入这块的分析，包括原理、源码、其它三个部分。</p>
<h1 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h1><p>在linux上，想要去做so库的动态注入无非这么几步：<br>1、注入器（injector）使用ptrace挂载目标进程<br>2、注入器注入加载器（loader）到目标进程<br>3、加载器被触发进行so库注入<br>4、目标进程初始状态还原和卸载ptrace</p>
<p>下面简单展开一下：</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2020/07/06/Linux-ptrace-so%E5%BA%93%E6%B3%A8%E5%85%A5%E5%88%86%E6%9E%90/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-image">
        <a href="/2019/10/29/DameWare-Remote-Support%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/4.png" alt="DameWare Remote Support缓冲区溢出漏洞复现">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2019-10-29</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-07-06T02:08:50.284Z">2020-07-06</time>
	
                
                
                <span class="level-item has-text-grey">
                    
                    
                    9 分钟 读完 (大约 1409 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/10/29/DameWare-Remote-Support%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/">DameWare Remote Support缓冲区溢出漏洞复现</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="0x01-漏洞描述"><a href="#0x01-漏洞描述" class="headerlink" title="0x01 漏洞描述"></a>0x01 漏洞描述</h2><p>DameWare是windows上一款著名的远控软件，其在2019年7月刚被曝出某处存在缓冲区溢出攻击，并可执行任意代码，影响版本V.12.1.0.34，这边做一下复现，环境是win 7(32位)。</p>
<h2 id="0x02-漏洞分析"><a href="#0x02-漏洞分析" class="headerlink" title="0x02 漏洞分析"></a>0x02 漏洞分析</h2><p>根据作者POC，在Tools->Computer Comments->Description功能下的ComputerName文本框内输入超长字符串会导致程序内存溢出崩溃，贴下图</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/10/29/DameWare-Remote-Support%E7%BC%93%E5%86%B2%E5%8C%BA%E6%BA%A2%E5%87%BA%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-image">
        <a href="/2019/10/22/BadUsb%E4%BB%8E%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E6%B8%97%E9%80%8F/" class="image is-7by1">
            <img class="thumbnail" src="/gallery/thumbnails/3.png" alt="BadUsb从协议分析到实战渗透">
        </a>
    </div>
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2019-10-22</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-07-06T02:08:50.265Z">2020-07-06</time>
	
                
                
                <span class="level-item has-text-grey">
                    
                    
                    10 分钟 读完 (大约 1486 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/10/22/BadUsb%E4%BB%8E%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E6%B8%97%E9%80%8F/">BadUsb从协议分析到实战渗透</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="0x00-锲子"><a href="#0x00-锲子" class="headerlink" title="0x00 锲子"></a>0x00 锲子</h2><p>这篇博文缘起公司一位单片机dalao的月末技术分享，当时觉得是挺有意思的，顺带着自己目前的研究方向又是偏向硬件（无线）、协议这一块，又恰好之前公司接了一家公司的授权实地渗透，当时有想法是就是扔badusb（捂脸），这边仅记录下学习过程。</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/10/22/BadUsb%E4%BB%8E%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90%E5%88%B0%E5%AE%9E%E6%88%98%E6%B8%97%E9%80%8F/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>









    
<div class="card">
    
    <div class="card-content article ">
        
        <div class="level article-meta is-size-7 is-uppercase is-mobile is-overflow-x-auto">
            <div class="level-left">
				<span class="level-item has-text-grey">写于2019-07-12</span>
				
    <i class="fas fa-calendar-check">&nbsp</i>
    <time class="level-item has-text-grey" datetime="2020-07-06T02:08:50.379Z">2020-07-06</time>
	
                
                <div class="level-item">
                <a class="has-link-grey -link" href="/categories/%E5%8D%8F%E8%AE%AE/">协议</a>
                </div>
                
                
                <span class="level-item has-text-grey">
                    
                    
                    7 分钟 读完 (大约 1072 个字)
                </span>
                
                
            </div>
        </div>
        
        <h1 class="title is-size-3 is-size-4-mobile has-text-weight-normal">
            
                <a class="has-link-black-ter" href="/2019/07/12/%E5%9F%BA%E4%BA%8Elua%E7%9A%84wireshark%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/">基于lua的wireshark协议解析插件编写</a>
            
        </h1>
        <div class="content">
            <html><head></head><body><h2 id="0x00-楔子"><a href="#0x00-楔子" class="headerlink" title="0x00 楔子"></a>0x00 楔子</h2><p>之前接到一个专网测试项目，其使用的是376.1协议进行通信，为了对其进行测试，这边选择对其进行协议分析，wireshark观察dump下来的数据包发现数据量并不多，所以打算写插件解析下。</p>
<h2 id="0x01-协议介绍"><a href="#0x01-协议介绍" class="headerlink" title="0x01 协议介绍"></a>0x01 协议介绍</h2><p>376.1协议全称 <code>国家电网公司企业标准(Q/GDW 376.1-2009):电力用户用电信息采集系统通信协议</code> 目前最新的是2013版本。</p></body></html>
        </div>
        
        
        <div class="level is-mobile">
            <div class="level-start">
                <div class="level-item">
                <a class="button is-size-7 is-light" href="/2019/07/12/%E5%9F%BA%E4%BA%8Elua%E7%9A%84wireshark%E5%8D%8F%E8%AE%AE%E8%A7%A3%E6%9E%90%E6%8F%92%E4%BB%B6%E7%BC%96%E5%86%99/#more">阅读更多</a>
                </div>
            </div>
        </div>
        
        
    </div>
</div>










    
<div class="card card-transparent">
    <nav class="pagination is-centered" role="navigation" aria-label="pagination">
        <div class="pagination-previous is-invisible is-hidden-mobile">
            <a class="is-flex-grow has-text-black-ter" href="/page/0/">上一页</a>
        </div>
        <div class="pagination-next">
            <a class="is-flex-grow has-text-black-ter" href="/page/2/">下一页</a>
        </div>
        <ul class="pagination-list is-hidden-mobile">
            
            <li><a class="pagination-link is-current" href="/">1</a></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/2/">2</a></li>
            
            <li><span class="pagination-ellipsis has-text-black-ter">&hellip;</span></li>
            
            <li><a class="pagination-link has-text-black-ter" href="/page/6/">6</a></li>
            
        </ul>
    </nav>
</div>
</div>
                




<div class="column is-4-tablet is-4-desktop is-3-widescreen  has-order-1 column-left ">
    
        
<div class="card widget">
    <div class="card-content">
        <nav class="level">
            <div class="level-item has-text-centered" style="flex-shrink: 1">
                <div>
                    
                    <figure class="image is-128x128 has-mb-6">
                        <img class="" src="/images/author.jpg" alt="XDW">
                    </figure>
                    
                    <p class="is-size-4 is-block">
                        XDW
                    </p>
                    
                    
                    <p class="is-size-6 is-block">
                        Security/HIDS/Kernel
                    </p>
                    
                    
                    <p class="is-size-6 is-flex is-flex-center has-text-grey">
                        <i class="fas fa-map-marker-alt has-mr-7"></i>
                        <span>China,Hangzhou</span>
                    </p>
                    
                </div>
            </div>
        </nav>
        <nav class="level is-mobile">
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        文章
                    </p>
                    <p class="title has-text-weight-normal">
                        56
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        分类
                    </p>
                    <p class="title has-text-weight-normal">
                        30
                    </p>
                </div>
            </div>
            <div class="level-item has-text-centered is-marginless">
                <div>
                    <p class="heading">
                        标签
                    </p>
                    <p class="title has-text-weight-normal">
                        43
                    </p>
                </div>
            </div>
        </nav>
        
        <div class="level">
            <a class="level-item button is-link is-rounded" href="https://github.com/driverxdw" target="_blank">
                关注我</a>
        </div>
        
        
        
        <div class="level is-mobile">
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Github" href="https://github.com/ppoffice">
                
                <i class="fab fa-github"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Facebook" href="https://facebook.com">
                
                <i class="fab fa-facebook"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Twitter" href="https://twitter.com">
                
                <i class="fab fa-twitter"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="Dribbble" href="https://dribbble.com">
                
                <i class="fab fa-dribbble"></i>
                
            </a>
            
            <a class="level-item button is-white is-marginless" target="_blank"
                title="RSS" href="/">
                
                <i class="fas fa-rss"></i>
                
            </a>
            
        </div>
        
    </div>
</div>
    
        
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            友链
        </h3>
        <ul class="menu-list">
        
            <li>
                <a class="level is-mobile" href="https://blog.ixuchao.cn/" target="_blank">
                    <span class="level-left">
                        <span class="level-item">Archerx&#39;s Blog</span>
                    </span>
                    <span class="level-right">
                        <span class="level-item tag">blog.ixuchao.cn</span>
                    </span>
                </a>
            </li>
        
        </ul>
        </div>
    </div>
</div>

    
        
<div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                分类
            </h3>
            <ul class="menu-list">
            <li>
        <a class="level is-marginless" href="/categories/2018%E5%9B%BD%E8%B5%9B/">
            <span class="level-start">
                <span class="level-item">2018国赛</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/2019%E5%9B%BD%E8%B5%9B/">
            <span class="level-start">
                <span class="level-item">2019国赛</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/CTF/">
            <span class="level-start">
                <span class="level-item">CTF</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Defcon-Group-010/">
            <span class="level-start">
                <span class="level-item">Defcon_Group_010</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Fuzz/">
            <span class="level-start">
                <span class="level-item">Fuzz</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">3</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/HIDS/">
            <span class="level-start">
                <span class="level-item">HIDS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/HTTP/">
            <span class="level-start">
                <span class="level-item">HTTP</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/ISITDTU-CTF/">
            <span class="level-start">
                <span class="level-item">ISITDTU_CTF</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/IoT/">
            <span class="level-start">
                <span class="level-item">IoT</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/PWN%E7%BB%83%E4%B9%A0/">
            <span class="level-start">
                <span class="level-item">PWN练习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">6</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Python/">
            <span class="level-start">
                <span class="level-item">Python</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/RE/">
            <span class="level-start">
                <span class="level-item">RE</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Rootkit-HIDS/">
            <span class="level-start">
                <span class="level-item">Rootkit, HIDS</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/Tools/">
            <span class="level-start">
                <span class="level-item">Tools</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/XMAN%E5%A4%8F%E4%BB%A4%E8%90%A5/">
            <span class="level-start">
                <span class="level-item">XMAN夏令营</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">5</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/pwn%E7%BB%83%E4%B9%A0/">
            <span class="level-start">
                <span class="level-item">pwn练习</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E4%B8%8A%E6%B5%B7%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E5%A4%A7%E8%B5%9B/">
            <span class="level-start">
                <span class="level-item">上海网络安全大赛</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E4%B8%96%E5%AE%89%E6%9D%AF/">
            <span class="level-start">
                <span class="level-item">世安杯</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E5%8D%8F%E8%AE%AE/">
            <span class="level-start">
                <span class="level-item">协议</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E6%80%BB%E7%BB%93/">
            <span class="level-start">
                <span class="level-item">总结</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E6%B5%85%E8%B0%88%E9%9A%8F%E7%AC%94/">
            <span class="level-start">
                <span class="level-item">浅谈随笔</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E6%BC%8F%E6%B4%9E/">
            <span class="level-start">
                <span class="level-item">漏洞</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E7%9C%81%E4%BF%A1%E5%AE%89/">
            <span class="level-start">
                <span class="level-item">省信安</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E7%A0%B4%E8%A7%A3%E4%B9%8B%E8%B7%AF/">
            <span class="level-start">
                <span class="level-item">破解之路</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">2</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E7%BD%91%E9%BC%8E%E6%9D%AF/">
            <span class="level-start">
                <span class="level-item">网鼎杯</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">4</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E8%99%9A%E6%8B%9F%E5%8C%96/">
            <span class="level-start">
                <span class="level-item">虚拟化</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E8%99%9A%E6%8B%9F%E6%9C%BA/">
            <span class="level-start">
                <span class="level-item">虚拟机</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">
            <span class="level-start">
                <span class="level-item">读书笔记</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E9%9D%A2%E8%AF%95/">
            <span class="level-start">
                <span class="level-item">面试</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li><li>
        <a class="level is-marginless" href="/categories/%E9%A1%B9%E7%9B%AE/">
            <span class="level-start">
                <span class="level-item">项目</span>
            </span>
            <span class="level-end">
                <span class="level-item tag">1</span>
            </span>
        </a></li>
            </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            最新文章
        </h3>
        
        <article class="media">
            
            <a href="/2020/08/30/Netstat-Source-Code-Debug/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Netstat Source Code Debug">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-30T10:27:23.000Z">2020-08-30</time></div>
                    <a href="/2020/08/30/Netstat-Source-Code-Debug/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Netstat Source Code Debug</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/08/09/rootkit-sys-call-table-hook-learning/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="rootkit sys_call_table hook learning">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-09T14:12:08.000Z">2020-08-09</time></div>
                    <a href="/2020/08/09/rootkit-sys-call-table-hook-learning/" class="title has-link-black-ter is-size-6 has-text-weight-normal">rootkit sys_call_table hook learning</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/Rootkit-HIDS/">Rootkit, HIDS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/08/02/Libpcap%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="Libpcap性能问题总结">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-02T11:50:50.000Z">2020-08-02</time></div>
                    <a href="/2020/08/02/Libpcap%E6%80%A7%E8%83%BD%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/" class="title has-link-black-ter is-size-6 has-text-weight-normal">Libpcap性能问题总结</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/08/02/%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E7%9A%84%E4%BD%93%E7%B3%BB%E5%8C%96%E6%A3%80%E6%B5%8B%E6%B5%81%E7%A8%8B/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="挖矿病毒的体系化检测流程">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-08-01T17:16:04.000Z">2020-08-02</time></div>
                    <a href="/2020/08/02/%E6%8C%96%E7%9F%BF%E7%97%85%E6%AF%92%E7%9A%84%E4%BD%93%E7%B3%BB%E5%8C%96%E6%A3%80%E6%B5%8B%E6%B5%81%E7%A8%8B/" class="title has-link-black-ter is-size-6 has-text-weight-normal">挖矿病毒的体系化检测流程</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/HIDS/">HIDS</a>
                    </p>
                </div>
            </div>
        </article>
        
        <article class="media">
            
            <a href="/2020/07/07/%E5%85%B3%E4%BA%8E%E6%AF%95%E4%B8%9A%E5%85%A5%E8%81%8C%E5%90%8E%E7%9A%84%E6%96%B0%E8%A7%84%E5%88%92/" class="media-left">
                <p class="image is-64x64">
                    <img class="thumbnail" src="/images/thumbnail.svg" alt="关于毕业入职后的新规划">
                </p>
            </a>
            
            <div class="media-content">
                <div class="content">
                    <div><time class="has-text-grey is-size-7 is-uppercase" datetime="2020-07-06T17:22:25.000Z">2020-07-07</time></div>
                    <a href="/2020/07/07/%E5%85%B3%E4%BA%8E%E6%AF%95%E4%B8%9A%E5%85%A5%E8%81%8C%E5%90%8E%E7%9A%84%E6%96%B0%E8%A7%84%E5%88%92/" class="title has-link-black-ter is-size-6 has-text-weight-normal">关于毕业入职后的新规划</a>
                    <p class="is-size-7 is-uppercase">
                        <a class="has-link-grey -link" href="/categories/%E6%80%BB%E7%BB%93/">总结</a>
                    </p>
                </div>
            </div>
        </article>
        
    </div>
</div>
    
    
        <div class="column-right-shadow is-hidden-widescreen ">
        
            <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/Fuzz/" style="font-size: 12.86px;">Fuzz</a> <a href="/tags/IDA/" style="font-size: 10px;">IDA</a> <a href="/tags/IoT/" style="font-size: 11.43px;">IoT</a> <a href="/tags/NTP/" style="font-size: 10px;">NTP</a> <a href="/tags/OD/" style="font-size: 10px;">OD</a> <a href="/tags/PWN/" style="font-size: 18.57px;">PWN</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/RE/" style="font-size: 15.71px;">RE</a> <a href="/tags/Tools/" style="font-size: 12.86px;">Tools</a> <a href="/tags/WP/" style="font-size: 10px;">WP</a> <a href="/tags/Windows%E9%80%86%E5%90%91/" style="font-size: 10px;">Windows逆向</a> <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/" style="font-size: 17.14px;">二进制</a> <a href="/tags/%E4%BA%BA%E7%94%9F/" style="font-size: 10px;">人生</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E4%BF%9D%E6%8A%A4/" style="font-size: 10px;">代码保护</a> <a href="/tags/%E5%8D%8F%E8%AE%AE/" style="font-size: 10px;">协议</a> <a href="/tags/%E5%8E%9F%E7%90%86/" style="font-size: 10px;">原理</a> <a href="/tags/%E5%A4%8D%E7%8E%B0/" style="font-size: 10px;">复现</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 11.43px;">开发</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 14.29px;">总结</a> <a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 11.43px;">感悟</a> <a href="/tags/%E6%94%BB%E9%98%B2/" style="font-size: 14.29px;">攻防</a> <a href="/tags/%E6%97%A0%E7%BA%BF/" style="font-size: 10px;">无线</a> <a href="/tags/%E6%9C%BA%E5%88%B6/" style="font-size: 10px;">机制</a> <a href="/tags/%E6%B5%85%E8%B0%88%E9%9A%8F%E7%AC%94/" style="font-size: 10px;">浅谈随笔</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 10px;">渗透</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8/" style="font-size: 11.43px;">游戏安全</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 12.86px;">源码分析</a> <a href="/tags/%E6%BC%8F%E6%B4%9E/" style="font-size: 11.43px;">漏洞</a> <a href="/tags/%E7%90%86%E6%83%B3/" style="font-size: 11.43px;">理想</a> <a href="/tags/%E7%A0%B4%E8%A7%A3/" style="font-size: 10px;">破解</a> <a href="/tags/%E7%A1%AC%E4%BB%B6/" style="font-size: 10px;">硬件</a> <a href="/tags/%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3/" style="font-size: 10px;">约束求解</a> <a href="/tags/%E7%BA%BF%E4%B8%8B%E6%94%BB%E9%98%B2/" style="font-size: 10px;">线下攻防</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%99%A8/" style="font-size: 10px;">编译器</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 10px;">虚拟机</a> <a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size: 10px;">调试</a> <a href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" style="font-size: 10px;">路由器</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 10px;">面试</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 10px;">项目</a>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/08/">
                <span class="level-start">
                    <span class="level-item">八月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">七月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">十月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">10</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">九月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">四月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">十月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
        
            <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/AWD/">
                        <span class="tag">AWD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/C/">
                        <span class="tag">C++</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CTF/">
                        <span class="tag">CTF</span>
                        <span class="tag is-grey">28</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Fuzz/">
                        <span class="tag">Fuzz</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IDA/">
                        <span class="tag">IDA</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IoT/">
                        <span class="tag">IoT</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/NTP/">
                        <span class="tag">NTP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OD/">
                        <span class="tag">OD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PWN/">
                        <span class="tag">PWN</span>
                        <span class="tag is-grey">24</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Python/">
                        <span class="tag">Python</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RE/">
                        <span class="tag">RE</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Tools/">
                        <span class="tag">Tools</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/WP/">
                        <span class="tag">WP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Windows%E9%80%86%E5%90%91/">
                        <span class="tag">Windows逆向</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/">
                        <span class="tag">二进制</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F/">
                        <span class="tag">人生</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E4%BB%A3%E7%A0%81%E4%BF%9D%E6%8A%A4/">
                        <span class="tag">代码保护</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%8D%8F%E8%AE%AE/">
                        <span class="tag">协议</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%8E%9F%E7%90%86/">
                        <span class="tag">原理</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%A4%8D%E7%8E%B0/">
                        <span class="tag">复现</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7/">
                        <span class="tag">工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91/">
                        <span class="tag">开发</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%80%BB%E7%BB%93/">
                        <span class="tag">总结</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%84%9F%E6%82%9F/">
                        <span class="tag">感悟</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%94%BB%E9%98%B2/">
                        <span class="tag">攻防</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%97%A0%E7%BA%BF/">
                        <span class="tag">无线</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%9C%BA%E5%88%B6/">
                        <span class="tag">机制</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%B5%85%E8%B0%88%E9%9A%8F%E7%AC%94/">
                        <span class="tag">浅谈随笔</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%B8%97%E9%80%8F/">
                        <span class="tag">渗透</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8/">
                        <span class="tag">游戏安全</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">
                        <span class="tag">源码分析</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%BC%8F%E6%B4%9E/">
                        <span class="tag">漏洞</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%90%86%E6%83%B3/">
                        <span class="tag">理想</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%A0%B4%E8%A7%A3/">
                        <span class="tag">破解</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%A1%AC%E4%BB%B6/">
                        <span class="tag">硬件</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3/">
                        <span class="tag">约束求解</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BA%BF%E4%B8%8B%E6%94%BB%E9%98%B2/">
                        <span class="tag">线下攻防</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BC%96%E8%AF%91%E5%99%A8/">
                        <span class="tag">编译器</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">
                        <span class="tag">虚拟机</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%B0%83%E8%AF%95/">
                        <span class="tag">调试</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">
                        <span class="tag">路由器</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95/">
                        <span class="tag">面试</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%A1%B9%E7%9B%AE/">
                        <span class="tag">项目</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
        
        </div>
    
</div>

                




<div class="column is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only has-order-3 column-right ">
    
        <div class="card widget">
    <div class="card-content">
        <h3 class="menu-label">
            标签云
        </h3>
        <a href="/tags/AWD/" style="font-size: 10px;">AWD</a> <a href="/tags/C/" style="font-size: 10px;">C++</a> <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/Fuzz/" style="font-size: 12.86px;">Fuzz</a> <a href="/tags/IDA/" style="font-size: 10px;">IDA</a> <a href="/tags/IoT/" style="font-size: 11.43px;">IoT</a> <a href="/tags/NTP/" style="font-size: 10px;">NTP</a> <a href="/tags/OD/" style="font-size: 10px;">OD</a> <a href="/tags/PWN/" style="font-size: 18.57px;">PWN</a> <a href="/tags/Python/" style="font-size: 10px;">Python</a> <a href="/tags/RE/" style="font-size: 15.71px;">RE</a> <a href="/tags/Tools/" style="font-size: 12.86px;">Tools</a> <a href="/tags/WP/" style="font-size: 10px;">WP</a> <a href="/tags/Windows%E9%80%86%E5%90%91/" style="font-size: 10px;">Windows逆向</a> <a href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/" style="font-size: 17.14px;">二进制</a> <a href="/tags/%E4%BA%BA%E7%94%9F/" style="font-size: 10px;">人生</a> <a href="/tags/%E4%BB%A3%E7%A0%81%E4%BF%9D%E6%8A%A4/" style="font-size: 10px;">代码保护</a> <a href="/tags/%E5%8D%8F%E8%AE%AE/" style="font-size: 10px;">协议</a> <a href="/tags/%E5%8E%9F%E7%90%86/" style="font-size: 10px;">原理</a> <a href="/tags/%E5%A4%8D%E7%8E%B0/" style="font-size: 10px;">复现</a> <a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size: 10px;">工具</a> <a href="/tags/%E5%BC%80%E5%8F%91/" style="font-size: 11.43px;">开发</a> <a href="/tags/%E6%80%BB%E7%BB%93/" style="font-size: 14.29px;">总结</a> <a href="/tags/%E6%84%9F%E6%82%9F/" style="font-size: 11.43px;">感悟</a> <a href="/tags/%E6%94%BB%E9%98%B2/" style="font-size: 14.29px;">攻防</a> <a href="/tags/%E6%97%A0%E7%BA%BF/" style="font-size: 10px;">无线</a> <a href="/tags/%E6%9C%BA%E5%88%B6/" style="font-size: 10px;">机制</a> <a href="/tags/%E6%B5%85%E8%B0%88%E9%9A%8F%E7%AC%94/" style="font-size: 10px;">浅谈随笔</a> <a href="/tags/%E6%B8%97%E9%80%8F/" style="font-size: 10px;">渗透</a> <a href="/tags/%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8/" style="font-size: 11.43px;">游戏安全</a> <a href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/" style="font-size: 12.86px;">源码分析</a> <a href="/tags/%E6%BC%8F%E6%B4%9E/" style="font-size: 11.43px;">漏洞</a> <a href="/tags/%E7%90%86%E6%83%B3/" style="font-size: 11.43px;">理想</a> <a href="/tags/%E7%A0%B4%E8%A7%A3/" style="font-size: 10px;">破解</a> <a href="/tags/%E7%A1%AC%E4%BB%B6/" style="font-size: 10px;">硬件</a> <a href="/tags/%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3/" style="font-size: 10px;">约束求解</a> <a href="/tags/%E7%BA%BF%E4%B8%8B%E6%94%BB%E9%98%B2/" style="font-size: 10px;">线下攻防</a> <a href="/tags/%E7%BC%96%E8%AF%91%E5%99%A8/" style="font-size: 10px;">编译器</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 10px;">虚拟机</a> <a href="/tags/%E8%B0%83%E8%AF%95/" style="font-size: 10px;">调试</a> <a href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/" style="font-size: 10px;">路由器</a> <a href="/tags/%E9%9D%A2%E8%AF%95/" style="font-size: 10px;">面试</a> <a href="/tags/%E9%A1%B9%E7%9B%AE/" style="font-size: 10px;">项目</a>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
        <h3 class="menu-label">
            归档
        </h3>
        <ul class="menu-list">
        
        <li>
            <a class="level is-marginless" href="/archives/2020/08/">
                <span class="level-start">
                    <span class="level-item">八月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2020/07/">
                <span class="level-start">
                    <span class="level-item">七月 2020</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">3</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/10/">
                <span class="level-start">
                    <span class="level-item">十月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/07/">
                <span class="level-start">
                    <span class="level-item">七月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/05/">
                <span class="level-start">
                    <span class="level-item">五月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/04/">
                <span class="level-start">
                    <span class="level-item">四月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">10</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2019/03/">
                <span class="level-start">
                    <span class="level-item">三月 2019</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">4</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/09/">
                <span class="level-start">
                    <span class="level-item">九月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/08/">
                <span class="level-start">
                    <span class="level-item">八月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">9</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/07/">
                <span class="level-start">
                    <span class="level-item">七月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">6</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/05/">
                <span class="level-start">
                    <span class="level-item">五月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2018/04/">
                <span class="level-start">
                    <span class="level-item">四月 2018</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">2</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/11/">
                <span class="level-start">
                    <span class="level-item">十一月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">5</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/10/">
                <span class="level-start">
                    <span class="level-item">十月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        <li>
            <a class="level is-marginless" href="/archives/2017/09/">
                <span class="level-start">
                    <span class="level-item">九月 2017</span>
                </span>
                <span class="level-end">
                    <span class="level-item tag">1</span>
                </span>
            </a>
        </li>
        
        </ul>
        </div>
    </div>
</div>
    
        <div class="card widget">
    <div class="card-content">
        <div class="menu">
            <h3 class="menu-label">
                标签
            </h3>
            <div class="field is-grouped is-grouped-multiline">
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/AWD/">
                        <span class="tag">AWD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/C/">
                        <span class="tag">C++</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/CTF/">
                        <span class="tag">CTF</span>
                        <span class="tag is-grey">28</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Fuzz/">
                        <span class="tag">Fuzz</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IDA/">
                        <span class="tag">IDA</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/IoT/">
                        <span class="tag">IoT</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/NTP/">
                        <span class="tag">NTP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/OD/">
                        <span class="tag">OD</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/PWN/">
                        <span class="tag">PWN</span>
                        <span class="tag is-grey">24</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Python/">
                        <span class="tag">Python</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/RE/">
                        <span class="tag">RE</span>
                        <span class="tag is-grey">5</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Tools/">
                        <span class="tag">Tools</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/WP/">
                        <span class="tag">WP</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/Windows%E9%80%86%E5%90%91/">
                        <span class="tag">Windows逆向</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/">
                        <span class="tag">二进制</span>
                        <span class="tag is-grey">6</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E4%BA%BA%E7%94%9F/">
                        <span class="tag">人生</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E4%BB%A3%E7%A0%81%E4%BF%9D%E6%8A%A4/">
                        <span class="tag">代码保护</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%8D%8F%E8%AE%AE/">
                        <span class="tag">协议</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%8E%9F%E7%90%86/">
                        <span class="tag">原理</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%A4%8D%E7%8E%B0/">
                        <span class="tag">复现</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%B7%A5%E5%85%B7/">
                        <span class="tag">工具</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E5%BC%80%E5%8F%91/">
                        <span class="tag">开发</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%80%BB%E7%BB%93/">
                        <span class="tag">总结</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%84%9F%E6%82%9F/">
                        <span class="tag">感悟</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%94%BB%E9%98%B2/">
                        <span class="tag">攻防</span>
                        <span class="tag is-grey">4</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%97%A0%E7%BA%BF/">
                        <span class="tag">无线</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%9C%BA%E5%88%B6/">
                        <span class="tag">机制</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%B5%85%E8%B0%88%E9%9A%8F%E7%AC%94/">
                        <span class="tag">浅谈随笔</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%B8%97%E9%80%8F/">
                        <span class="tag">渗透</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%B8%B8%E6%88%8F%E5%AE%89%E5%85%A8/">
                        <span class="tag">游戏安全</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90/">
                        <span class="tag">源码分析</span>
                        <span class="tag is-grey">3</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E6%BC%8F%E6%B4%9E/">
                        <span class="tag">漏洞</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%90%86%E6%83%B3/">
                        <span class="tag">理想</span>
                        <span class="tag is-grey">2</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%A0%B4%E8%A7%A3/">
                        <span class="tag">破解</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%A1%AC%E4%BB%B6/">
                        <span class="tag">硬件</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BA%A6%E6%9D%9F%E6%B1%82%E8%A7%A3/">
                        <span class="tag">约束求解</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BA%BF%E4%B8%8B%E6%94%BB%E9%98%B2/">
                        <span class="tag">线下攻防</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E7%BC%96%E8%AF%91%E5%99%A8/">
                        <span class="tag">编译器</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">
                        <span class="tag">虚拟机</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%B0%83%E8%AF%95/">
                        <span class="tag">调试</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E8%B7%AF%E7%94%B1%E5%99%A8/">
                        <span class="tag">路由器</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%9D%A2%E8%AF%95/">
                        <span class="tag">面试</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
                <div class="control">
                    <a class="tags has-addons" href="/tags/%E9%A1%B9%E7%9B%AE/">
                        <span class="tag">项目</span>
                        <span class="tag is-grey">1</span>
                    </a>
                </div>
                
            </div>
        </div>
    </div>
</div>
    
    
</div>

            </div>
        </div>
    </section>
    <footer class="footer">
    <div class="container">
        <div class="level">
            <div class="level-start has-text-centered-mobile">
                <a class="footer-logo is-block has-mb-6" href="/">
                
                    <img src="/images/logo.svg" alt="in0va&#39;S Blog  JustLearnM0re" height="28">
                
                </a>
                <p class="is-size-7">
                &copy; 2020 xdw&nbsp;
                Powered by <a href="https://hexo.io/" target="_blank">Hexo</a> & <a
                        href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank">Icarus</a>
                
                <br>
                <span id="busuanzi_container_site_uv">
                共<span id="busuanzi_value_site_uv">0</span>个访客
                </span>
                
                </p>
            </div>
            <div class="level-end">
            
                <div class="field has-addons is-flex-center-mobile has-mt-5-mobile is-flex-wrap is-flex-middle">
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Creative Commons" href="https://creativecommons.org/">
                        
                        <i class="fab fa-creative-commons"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/">
                        
                        <i class="fab fa-creative-commons-by"></i>
                        
                    </a>
                </p>
                
                <p class="control">
                    <a class="button is-white is-large" target="_blank" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus">
                        
                        <i class="fab fa-github"></i>
                        
                    </a>
                </p>
                
                </div>
            
            </div>
        </div>
    </div>
</footer>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script>
<script>moment.locale("zh-CN");</script>

<script>
var IcarusThemeSettings = {
    article: {
        highlight: {
            clipboard: true,
            fold: 'unfolded'
        }
    }
};
</script>


    <script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script>



    
    
<script src="/js/animation.js"></script>

    
    
<script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script>
<script src="/js/gallery.js" defer></script>

    
    
<div id="outdated">
    <h6>Your browser is out-of-date!</h6>
    <p>Update your browser to view this website correctly. <a id="btnUpdateBrowser" href="http://outdatedbrowser.com/" target="_blank" rel="noopener">Update
            my browser now </a></p>
    <p class="last"><a href="#" id="btnCloseUpdateBrowser" title="Close">&times;</a></p>
</div>
<script src="https://cdn.jsdelivr.net/npm/outdatedbrowser@1.1.5/outdatedbrowser/outdatedbrowser.min.js" defer></script>
<script>
    document.addEventListener("DOMContentLoaded", function () {
        outdatedBrowser({
            bgColor: '#f25648',
            color: '#ffffff',
            lowerThan: 'flex'
        });
    });
</script>

    
    <script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.5/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script>
<script>
document.addEventListener('DOMContentLoaded', function () {
    MathJax.Hub.Config({
        'HTML-CSS': {
            matchFontHeight: false
        },
        SVG: {
            matchFontHeight: false
        },
        CommonHTML: {
            matchFontHeight: false
        },
        tex2jax: {
            inlineMath: [
                ['$','$'],
                ['\\(','\\)']
            ]
        }
    });
});
</script>
    
    
<a id="back-to-top" title="回到顶端" href="javascript:;">
    <i class="fas fa-chevron-up"></i>
</a>
<script src="/js/back-to-top.js" defer></script>

    
    
    
    
    
    
    
    
    
    
    


<script src="/js/main.js" defer></script>

    
    <div class="searchbox ins-search">
    <div class="searchbox-container ins-search-container">
        <div class="searchbox-input-wrapper">
            <input type="text" class="searchbox-input ins-search-input" placeholder="想要查找什么..." />
            <span class="searchbox-close ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="searchbox-result-wrapper ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
    (function (window) {
        var INSIGHT_CONFIG = {
            TRANSLATION: {
                POSTS: '文章',
                PAGES: '页面',
                CATEGORIES: '分类',
                TAGS: '标签',
                UNTITLED: '(无标题)',
            },
            CONTENT_URL: '/content.json',
        };
        window.INSIGHT_CONFIG = INSIGHT_CONFIG;
    })(window);
</script>
<script src="/js/insight.js" defer></script>
<link rel="stylesheet" href="/css/search.css">
<link rel="stylesheet" href="/css/insight.css">
    
</body>
</html>